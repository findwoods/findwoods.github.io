![](https://cdn.mathpix.com/cropped/2024_12_20_b7e31d481f69dee18878g-052.jpg?height=847&width=1234&top_left_y=53&top_left_x=125)

德国数学家卡尔 • 弗里德里希 • 高斯（1777-1855），他于1809 年发表了求解线性方程组的一种方法,现在称为高斯消元法。早在 1600 多年前，中国的一本书中就已经使用这种方法了。

## 线性映射

迄今我们所关注的都是向量空间，这并不怎么让人兴奋. 线性代数真正让人感兴趣的部分是我们现在要讨论的主题——线性映射.

在这一章, 我们还经常需要 $V$ 之外的另一个向量空间 $W$, 所以从现在开始我们总采用如下假定：
3.1 记号 F、V、W

- $\mathbf{F}$ 表示 $\mathbf{R}$ 或 $\mathbf{C}$.
- $V$ 和 $W$ 表示 $\mathbf{F}$ 上的向量空间.


## 本章的学习目标

- 线性映射基本定理
- 线性映射关于给定基的矩阵
- 同构的向量空间
- 积空间
- 商空间
- 向量空间的对偶空间与线性映射的对偶映射


## 3.A 向量空间的线性映射

## 线性映射的定义和例子

现在给出线性代数中的一个重要概念.

## 3.2 定义 线性映射（linear map）

从 $V$ 到 $W$ 的线性映射是具有下列性质的函数 $T: V \rightarrow W$ :

## 加性 (additivity)

对所有 $u, v \in V$ 都有 $T(u+v)=T u+T v ;$

## 齐性 (homogeneity)

对所有 $\lambda \in \mathbf{F}$ 和 $v \in V$ 都有 $T(\lambda v)=\lambda(T v)$.
注意，对于线性映射，我们经常使用记号 $T v$, 也使用更标准的函数记号 $T(v)$.

有些数学家使用 线性变换这个术语，意思与线性映射相同。

## 3.3 记号 $\mathcal{L}(V, W)$

从 $V$ 到 $W$ 的所有线性映射构成的集合记为 $\mathcal{L}(V, W)$.
我们来看看线性映射的一些例子. 务必验证下面定义的函数确实是线性映射.

## 3.4 例 线性映射

## 零（zero）

除做其他用途，我们也用符号 0 表示一个函数，它把某个向量空间的每个元素都映成另一个向量空间的加法单位元. 确切地说， $0 \in \mathcal{L}(V, W)$ 定义如下:

$$
0 v=0
$$

等式左边的 0 是从 $V$ 到 $W$ 的函数, 而右边的 0 是 $W$ 的加法单位元. 一般来说, 通过上下文可以辨别符号 0 的各种用法。

## 恒等 (identity)

恒等映射是某个向量空间上的函数，记为 $I$ ，它把每个元素都映成自身。确切地说， $I \in \mathcal{L}(V, V)$ 定义如下:

$$
I v=v
$$

微分 (differentiation)
定义 $D \in \mathcal{L}(\mathcal{P}(\mathbf{R}), \mathcal{P}(\mathbf{R}))$ 如下:

$$
D p=p^{\prime} \text {. }
$$

这个函数是线性的，此结论只是把关于微分的下述基本结果换了一种说法：对任意可微函数 $f, g$ 和常数 $\lambda$ 都有 $(f+g)^{\prime}=f^{\prime}+g^{\prime},(\lambda f)^{\prime}=\lambda f^{\prime}$.

## 积分 (integration)

定义 $T \in \mathcal{L}(\mathcal{P}(\mathbf{R}), \mathbf{R})$ 如下:

$$
T p=\int_{0}^{1} p(x) \mathrm{d} x
$$

这个函数是线性的，此结论只是把关于积分的下述基本结果换了一种说法：两个函数之和的积分等于这两个函数积分的和，常数与函数乘积的积分等于常数乘以函数的积分.

乘以 $x^{2}$ （multiplication by $x^{2}$ )
定义 $T \in \mathcal{L}(\mathcal{P}(\mathbf{R}), \mathcal{P}(\mathbf{R}))$ 如下: 对所有 $x \in \mathbf{R}$

$$
(T p)(x)=x^{2} p(x)
$$

## 向后移位（backward shift）

回忆一下， $\mathbf{F}^{\infty}$ 表示 $\mathbf{F}$ 中元素的无穷序列构成的向量空间。定义 $T \in \mathcal{L}\left(\mathbf{F}^{\infty}, \mathbf{F}^{\infty}\right)$ 如下：

$$
T\left(x_{1}, x_{2}, x_{3}, \ldots\right)=\left(x_{2}, x_{3}, \ldots\right)
$$

## 从 $\mathbf{R}^{3}$ 到 $\mathbf{R}^{2}$ （from $\mathbf{R}^{3}$ to $\mathbf{R}^{2}$ ）

定义 $T \in \mathcal{L}\left(\mathbf{R}^{3}, \mathbf{R}^{2}\right)$ 如下:

$$
T(x, y, z)=(2 x-y+3 z, 7 x+5 y-6 z)
$$

## 从 $\mathbf{F}^{n}$ 到 $\mathbf{F}^{m}$ （from $\mathbf{F}^{n}$ to $\mathbf{F}^{m}$ ）

把前一个例子推广一下，设 $m$ 和 $n$ 都是正整数， $A_{j, k} \in \mathbf{F}, j=1, \ldots, m, k=1, \ldots, n$ ，定义 $T \in \mathcal{L}\left(\mathbf{F}^{n}, \mathbf{F}^{m}\right)$ 如下:

$$
T\left(x_{1}, \ldots, x_{n}\right)=\left(A_{1,1} x_{1}+\cdots+A_{1, n} x_{n}, \ldots, A_{m, 1} x_{1}+\cdots+A_{m, n} x_{n}\right)
$$

事实上从 $\mathbf{F}^{n}$ 到 $\mathbf{F}^{m}$ 的每个线性映射都是这种形式的.

以下命题的存在性部分表明线性映射可根据其在一个基上的取值来构造，而唯一性部分表明一个线性映射完全由其在基上的取值确定。

## 3.5 线性映射与定义域的基

设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基， $w_{1}, \ldots, w_{n} \in W$ 。则存在唯一一个线性映射 $T: V \rightarrow W$使得对任意 $j=1, \ldots, n$ 都有

$$
T v_{j}=w_{j}
$$

证明 首先我们证明存在满足上述性质的线性映射 $T$. 定义 $T: V \rightarrow W$ 如下:

$$
T\left(c_{1} v_{1}+\cdots+c_{n} v_{n}\right)=c_{1} w_{1}+\cdots+c_{n} w_{n}
$$

其中 $c_{1}, \ldots, c_{n}$ 是 $\mathbf{F}$ 的任意元素。由于组 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基，所以上面的等式的确定义了从 $V$ 到 $W$ 的函数 $T$ （因为 $V$ 的每个元素都可唯一地写成 $c_{1} v_{1}+\cdots+c_{n} v_{n}$ 的形式）。

在上述等式中, 对每个 $j$, 取 $c_{j}=1$ 并取其他的 $c$ 为 0 , 则有 $T v_{j}=w_{j}$.若 $u, v \in V$ ，其中 $u=a_{1} v_{1}+\cdots+a_{n} v_{n}, v=c_{1} v_{1}+\cdots+c_{n} v_{n}$ ，则

$$
\begin{aligned}
T(u+v) & =T\left(\left(a_{1}+c_{1}\right) v_{1}+\cdots+\left(a_{n}+c_{n}\right) v_{n}\right) \\
& =\left(a_{1}+c_{1}\right) w_{1}+\cdots+\left(a_{n}+c_{n}\right) w_{n} \\
& =\left(a_{1} w_{1}+\cdots+a_{n} w_{n}\right)+\left(c_{1} w_{1}+\cdots+c_{n} w_{n}\right) \\
& =T u+T v
\end{aligned}
$$

类似地，若 $\lambda \in \mathbf{F}, v=c_{1} v_{1}+\cdots+c_{n} v_{n}$ ，则

$$
\begin{aligned}
T(\lambda v) & =T\left(\lambda c_{1} v_{1}+\cdots+\lambda c_{n} v_{n}\right) \\
& =\lambda c_{1} w_{1}+\cdots+\lambda c_{n} w_{n} \\
& =\lambda\left(c_{1} w_{1}+\cdots+c_{n} w_{n}\right) \\
& =\lambda T v
\end{aligned}
$$

因此 $T$ 是 $V$ 到 $W$ 的线性映射。
为了证明唯一性，现在假设 $T \in \mathcal{L}(V, W)$ 且 $T v_{j}=w_{j}, j=1, \ldots, n$. 设 $c_{1}, \ldots, c_{n} \in \mathbf{F}$. 由 $T$ 的齐次性，有 $T\left(c_{j} v_{j}\right)=c_{j} w_{j}, j=1, \ldots, n$ 。由 $T$ 的加性，有

$$
T\left(c_{1} v_{1}+\cdots+c_{n} v_{n}\right)=c_{1} w_{1}+\cdots+c_{n} w_{n}
$$

故 $T$ 在 $\operatorname{span}\left(v_{1}, \ldots, v_{n}\right)$ 上由上式唯一确定。由于 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基，故 $T$ 在 $V$ 上是唯一确定的。

## $\mathcal{L}(\boldsymbol{V}, \boldsymbol{W})$ 上的代数运算

我们先在 $\mathcal{L}(V, W)$ 上定义加法和标量乘法.

## 3.6 定义 $\mathcal{L}(V, W)$ 上的加法和标量乘法

(addition and scalar multipication on $\mathcal{L}(V, W)$ )
设 $S, T \in \mathcal{L}(V, W), \lambda \in \mathbf{F}$ 。定义和 $S+T$ 与积 $\lambda T$ 是 $V$ 到 $W$ 的两个线性映射：对所有 $v \in V$ 都有

$$
(S+T)(v)=S v+T v, \quad(\lambda T)(v)=\lambda(T v)
$$

尽管线性映射在整个数学中是广泛存在的，但并不是像某些学生想象的那样无处不在。这些呆萌的学生写下 $\cos 2 x=2 \cos x$ 和 $\cos (x+y)=\cos x+\cos y$, 似乎认为 $\cos$ 是 $\mathbf{R}$ 到 $\mathbf{R}$ 的线性映射.

请自行验证如上定义的 $S+T$ 和 $\lambda T$ 的确是线性映射. 也就是说，若 $S, T \in \mathcal{L}(V, W)$ ， $\lambda \in \mathbf{F}$ ，则 $S+T \in \mathcal{L}(V, W), \lambda T \in \mathcal{L}(V, W)$ 。

由于我们已经定义了 $\mathcal{L}(V, W)$ 上的加法和标量乘法，下面的结果就不足为奇了。

## $3.7 \mathcal{L}(V, W)$ 是向量空间

按照上面定义的加法和标量乘法， $\mathcal{L}(V, W)$ 是一个向量空间。
请自行证明上述命题。注意 $\mathcal{L}(V, W)$ 的加法单位元就是本节早先定义的零映射.
一般来说，向量空间中的两个元素相乘是没有意义的，但是对于一对适当的线性映射却存在一种有用的乘积. 我们还需要第三个向量空间，所以现在假设 $U$ 是 $\mathbf{F}$ 上的向量空间。

## 3.8 定义 线性映射的乘积 (product of linear maps)

若 $T \in \mathcal{L}(U, V), S \in \mathcal{L}(V, W)$, 则定义乘积 $S T \in \mathcal{L}(U, W)$ 如下:
对任意 $u \in U, \quad(S T)(u)=S(T u)$ 。
也就是说， $S T$ 恰为通常的函数复合 $S \circ T$ 。但是，若两个函数都是线性的，则大多数数学家都写成 $S T$ 而不是 $S \circ T$ 。请验证当 $T \in \mathcal{L}(U, V), S \in \mathcal{L}(V, W)$ 时 $S T$ 的确是从 $U$ 到 $W$ 的线性映射。

注意，只有当 $T$ 映到 $S$ 的定义域内时 $S T$ 才有定义。

## 3.9 线性映射乘积的代数性质

## 结合性（associativity）

$$
\left(T_{1} T_{2}\right) T_{3}=T_{1}\left(T_{2} T_{3}\right)
$$

这里 $T_{1}, T_{2}, T_{3}$ 都是线性映射，并且乘积都有意义（即 $T_{3}$ 必须映到 $T_{2}$ 的定义域内， $T_{2}$ 必须映到 $T_{1}$ 的定义域内）。

## 单位元（identity）

$$
T I=I T=T
$$

这里 $T \in \mathcal{L}(V, W)$ （第一个 $I$ 是 $V$ 上的恒等映射，而第二个 $I$ 是 $W$ 上的恒等映射）。

## 分配性质（distributive properties）

$$
\left(S_{1}+S_{2}\right) T=S_{1} T+S_{2} T \quad \text { 和 } \quad S\left(T_{1}+T_{2}\right)=S T_{1}+S T_{2}
$$

这里 $T, T_{1}, T_{2} \in \mathcal{L}(U, V), S, S_{1}, S_{2} \in \mathcal{L}(V, W)$.

上述结果的证明留给读者。
线性映射的乘法不是交换的. 也就是说， $S T=T S$ 未必成立，即使这个等式的两边都有意义.
3.10 例 设 $D \in \mathcal{L}(\mathcal{P}(\mathbf{R}), \mathcal{P}(\mathbf{R}))$ 是例 3.4 定义的微分映射， $T \in \mathcal{L}(\mathcal{P}(\mathbf{R}), \mathcal{P}(\mathbf{R}))$ 是本节前面定义的乘 $x^{2}$ 映射，证明 $T D \neq D T$ 。

证明 我们有

$$
((T D) p)(x)=x^{2} p^{\prime}(x) \quad \text { 但 } \quad((D T) p)(x)=x^{2} p^{\prime}(x)+2 x p(x) .
$$

也就是说，先乘以 $x^{2}$ 再微分和先微分再乘以 $x^{2}$ 是不同的.

### 3.11 线性映射将 0 映为 0

设 $T$ 是 $V$ 到 $W$ 的线性映射. 则 $T(0)=0$.
证明 利用加性，我们有

$$
T(0)=T(0+0)=T(0)+T(0)
$$

在上式两端都加上 $T(0)$ 的加法逆元, 即得 $T(0)=0$.

## 习题 3.A

1 设 $b, c \in \mathbf{R}$. 定义 $T: \mathbf{R}^{3} \rightarrow \mathbf{R}^{2}$ 如下:

$$
T(x, y, z)=(2 x-4 y+3 z+b, 6 x+c x y z)
$$

证明 $T$ 是线性的当且仅当 $b=c=0$.
2 设 $b, c \in \mathbf{R}$. 定义 $T: \mathcal{P}(\mathbf{R}) \rightarrow \mathbf{R}^{2}$ 如下:

$$
T p=\left(3 p(4)+5 p^{\prime}(6)+b p(1) p(2), \int_{-1}^{2} x^{3} p(x) \mathrm{d} x+c \sin p(0)\right)
$$

证明 $T$ 是线性的当且仅当 $b=c=0$.
3 设 $T \in \mathcal{L}\left(\mathbf{F}^{n}, \mathbf{F}^{m}\right)$ 。证明存在标量 $A_{j, k} \in \mathbf{F}$ （其中 $j=1, \ldots, m, k=1, \ldots, n$ ）使得对任意 $\left(x_{1}, \ldots, x_{n}\right) \in \mathbf{F}^{n}$ 都有

$$
T\left(x_{1}, \ldots, x_{n}\right)=\left(A_{1,1} x_{1}+\cdots+A_{1, n} x_{n}, \ldots, A_{m, 1} x_{1}+\cdots+A_{m, n} x_{n}\right)
$$

本题表明 $T$ 具有在例 3.4 的最后一条中提及的那种形式。
4 设 $T \in \mathcal{L}(V, W)$ 且 $v_{1}, \ldots, v_{m}$ 是 $V$ 中的向量组，使得 $T v_{1}, \ldots, T v_{m}$ 在 $W$ 中是线性无关的。证明 $v_{1}, \ldots, v_{m}$ 是线性无关的。
5 证明 3.7 中的结论。

6 证明 3.9 中的结论.
7 证明每个从一维向量空间到其自身的线性映射都是乘以某个标量. 准确地说, 证明：若 $\operatorname{dim} V=1$ 且 $T \in \mathcal{L}(V, V)$ ，则有 $\lambda \in \mathbf{F}$ 使得对所有 $v \in V$ 都有 $T v=\lambda v$ 。
$\mathbf{8}$ 给出一个函数 $\varphi: \mathbf{R}^{2} \rightarrow \mathbf{R}$, 使得对所有 $a \in \mathbf{R}$ 和所有 $v \in \mathbf{R}^{2}$ 有

$$
\varphi(a v)=a \varphi(v)
$$

但 $\varphi$ 不是线性的.
本题和下题表明齐性并不蕴涵线性，加性也不蕴涵线性。
9 给出一个函数 $\varphi: \mathbf{C} \rightarrow \mathbf{C}$, 使得对所有 $w, z \in \mathbf{C}$ 都有

$$
\varphi(w+z)=\varphi(w)+\varphi(z)
$$

但 $\varphi$ 不是线性的。（这里 $\mathbf{C}$ 视为一个复向量空间.）
也存在函数 $\varphi: \mathbf{R} \rightarrow \mathbf{R}$ 使得 $\varphi$ 满足上述加性条件但 $\varphi$ 不是线性的。但是, 证明其存在性涉及更高等的工具。

10 设 $U$ 是 $V$ 的子空间且 $U \neq V$. 设 $S \in \mathcal{L}(U, W)$ 且 $S \neq 0$ （这意味着对某个 $u \in U$有 $S u \neq 0$ )。定义 $T: V \rightarrow W$ 如下

$$
T v= \begin{cases}S v, & \text { 若 } v \in U, \\ 0, & \text { 若 } v \in V \text { 且 } v \notin U .\end{cases}
$$

证明 $T$ 不是 $V$ 上的线性映射。
11 设 $V$ 是有限维的。证明 $V$ 的子空间上的线性映射可以扩张成 $V$ 上的线性映射.也就是说，证明：如果 $U$ 是 $V$ 的子空间， $S \in \mathcal{L}(U, W)$ ，那么存在 $T \in \mathcal{L}(V, W)$使得对所有 $u \in U$ 都有 $T u=S u$.
12 设 $V$ 是有限维的且 $\operatorname{dim} V>0$, 再设 $W$ 是无限维的。证明 $\mathcal{L}(V, W)$ 是无限维的.
13 设 $v_{1}, \ldots, v_{m}$ 是 $V$ 中的一个线性相关的向量组，并设 $W \neq\{0\}$ 。证明存在 $w_{1}, \ldots, w_{m} \in W$ 使得没有 $T \in \mathcal{L}(V, W)$ 能满足 $T v_{k}=w_{k}, k=1, \ldots, m$ 。
14 设 $V$ 是有限维的且 $\operatorname{dim} V \geq 2$. 证明存在 $S, T \in \mathcal{L}(V, V)$ 使得 $S T \neq T S$.

## 3.B 零空间与值域

## 零空间与单射性

本节我们将学习与每一个线性映射紧密联系的两个子空间。先来看被映为 0 的向量构成的集合。
3.12 定义 零空间（null space），null $T$

对于 $T \in \mathcal{L}(V, W), T$ 的零空间（记为 null $T$ ）是指 $V$ 中那些被 $T$ 映为 0 的向量构成的子集：

$$
\operatorname{null} T=\{v \in V: T v=0\}
$$

### 3.13 例 零空间

- 若 $T$ 是 $V$ 到 $W$ 的零映射, 也就是说对每个 $v \in V$ 有 $T v=0$, 则 null $T=V$.
- 设 $\varphi \in \mathcal{L}\left(\mathbf{C}^{3}, \mathbf{F}\right)$ 定义为 $\varphi\left(z_{1}, z_{2}, z_{3}\right)=z_{1}+2 z_{2}+3 z_{3}$. 则 null $\varphi=\left\{\left(z_{1}, z_{2}, z_{3}\right) \in\right.$ $\left.\mathbf{C}^{3}: z_{1}+2 z_{2}+3 z_{3}=0\right\}$ ，并且 null $\varphi$ 的一个基为 $(-2,1,0),(-3,0,1)$.
- 设 $D \in \mathcal{L}(\mathcal{P}(\mathbf{R}), \mathcal{P}(\mathbf{R}))$ 是微分映射 $D p=p^{\prime}$ 。只有常函数的导数才能等于零函数。于是， $T$ 的零空间是常函数组成的集合。
- 设 $T \in \mathcal{L}(\mathcal{P}(\mathbf{R}), \mathcal{P}(\mathbf{R}))$ 是乘 $x^{2}$ 映射 $(T p)(x)=x^{2} p(x)$. 在 $x \in \mathbf{R}$ 时满足 $x^{2} p(x)=0$ 的多项式 $p$ 只有 0 多项式. 于是 null $T=\{0\}$.
- 设 $T \in \mathcal{L}\left(\mathbf{F}^{\infty}, \mathbf{F}^{\infty}\right)$ 是向后移位映射

$$
T\left(x_{1}, x_{2}, x_{3}, \ldots\right)=\left(x_{2}, x_{3}, \ldots\right)
$$

显然, $T\left(x_{1}, x_{2}, x_{3}, \ldots\right)$ 等于 0 当且仅当 $x_{2}, x_{3}, \ldots$ 都是 0 . 于是 null $T=$ $\{(a, 0,0, \ldots): a \in \mathbf{F}\}$.

下面的命题证明了线性映射的零空间是定义域的子空间。特别地， 0 包含于每个线性映射的零空间。

有些数学家使用术语核而不是零空间. null 一词的意思是零. 术语 "零空间"提醒我们这一概念与 0有关。

### 3.14 零空间是子空间

设 $T \in \mathcal{L}(V, W)$ ，则 $\operatorname{null} T$ 是 $V$ 的子空间。
证明 因为 $T$ 是线性映射，我们知道 $T(0)=0$ （由于 3.11 ）。所以 $0 \in \operatorname{null} T$ 。
设 $u, v \in \operatorname{null} T$. 则

$$
T(u+v)=T u+T v=0+0=0
$$

故 $u+v \in \operatorname{null} T$. 于是 null $T$ 对加法封闭.
设 $u \in \operatorname{null} T$ 且 $\lambda \in \mathbf{F}$. 则

$$
T(\lambda u)=\lambda T u=\lambda 0=0
$$

故 $\lambda u \in \operatorname{null} T$. 于是 null $T$ 对标量乘法封闭.

再看一下例3.13中计算过的零空间，注意它们都是子空间。

我们已经证明了 $\operatorname{null} T$ 包含 0 ，并且对加法和标量乘法都封闭。因此 null $T$ 是 $V$ 的子空间 （由于 1.34）。

我们将很快看到，对于线性映射，下面的定义与零空间联系密切.

### 3.15 定义 单的（injective）

如果当 $T u=T v$ 时必有 $u=v$, 则称映射 $T: V \rightarrow W$ 是单的.

很多数学家使用"一对一的"这个术语，意思与 "单的"相同。

上面的定义也可以重述为：称 $T$ 是单的，若当 $u \neq v$ 时必有 $T u \neq T v$ 。也就是说： $T$ 是单的，若它将不同的输入映为不同的输出。

下面的命题说的是：为了验证线性映射是单的，只需验证 0 是唯一一个被映成 0的向量. 作为这个命题的一个简单应用，我们看到 3.13 中的那些线性映射（其零空间已经算过了）只有乘 $x^{2}$ 映射是单的（除了零映射在 $V=\{0\}$ 的特殊情形是单的之外）。

### 3.16 单射性等价于零空间为 $\{0\}$

设 $T \in \mathcal{L}(V, W)$, 则 $T$ 是单的当且仅当 $\operatorname{null} T=\{0\}$.
证明 首先假设 $T$ 是单的. 我们要证明 null $T=\{0\}$ 。我们已经知道 $\{0\} \subset \operatorname{null} T$ （由 3.11）。为了证明另一个方向的包含关系，设 $v \in \operatorname{null} T$ 。则

$$
T(v)=0=T(0) .
$$

因为 $T$ 是单的, 故由上式可得 $v=0$. 于是 $\operatorname{null} T=\{0\}$.
为了证明另一方向的蕴涵关系，假设 null $T=\{0\}$ 。我们要证明 $T$ 是单的. 为此，设 $u, v \in V$ 且 $T u=T v$ ，那么

$$
0=T u-T v=T(u-v)
$$

因此 $u-v$ 在 $\operatorname{null} T$ 中, 这说明 $u-v=0$, 即 $u=v$. 于是 $T$ 是单的.

## 值域与满射性

现在我们给一个函数的输出集取个名字.

### 3.17 定义 值域（range）

对于 $V$ 到 $W$ 的映射 $T, T$ 的值域是 $W$ 中形如 $T v$ （其中 $v \in V$ ）的向量组成的子集：

$$
\text { range } T=\{T v: v \in V\} .
$$

### 3.18 例 值域

- 若 $T$ 是 $V$ 到 $W$ 的零映射, 即对所有 $v \in V$ 都有 $T v=0$, 则 range $T=\{0\}$.
- 设 $T \in \mathcal{L}\left(\mathbf{R}^{2}, \mathbf{R}^{3}\right)$ 定义为 $T(x, y)=(2 x, 5 y, x+y)$, 则

$$
\text { range } T=\{(2 x, 5 y, x+y): x, y \in \mathbf{R}\} .
$$

range $T$ 的一个基为 $(2,0,1),(0,5,1)$.

- 设 $D \in \mathcal{L}(\mathcal{P}(\mathbf{R}), \mathcal{P}(\mathbf{R}))$ 是微分映射 $D p=p^{\prime}$ 。由于对每个多项式 $q \in \mathcal{P}(\mathbf{R})$ 均存在多项式 $p \in \mathcal{P}(\mathbf{R})$ 使得 $p^{\prime}=q$, 故 $D$ 的值域是 $\mathcal{P}(\mathbf{R})$.

下面的命题证明了线性映射的值域是目标空间的子空间。

有些数学家使用像这个词，意思与值域相同。

### 3.19 值域是一个子空间

若 $T \in \mathcal{L}(V, W)$ ，则 range $T$ 是 $W$ 的子空间。
证明 设 $T \in \mathcal{L}(V, W)$. 则 $T(0)=0$ （由 3.11），故 $0 \in$ range $T$ 。
若 $w_{1}, w_{2} \in$ range $T$, 则存在 $v_{1}, v_{2} \in V$ 使得 $T v_{1}=w_{1}, T v_{2}=w_{2}$. 于是

$$
T\left(v_{1}+v_{2}\right)=T v_{1}+T v_{2}=w_{1}+w_{2} .
$$

故 $w_{1}+w_{2} \in \operatorname{range} T$ 。因此 range $T$ 对加法封闭.
若 $w \in \operatorname{range} T, \lambda \in \mathbf{F}$ ，则存在 $v \in V$ 使得 $T v=w$ 。于是

$$
T(\lambda v)=\lambda T v=\lambda w
$$

故 $\lambda w \in \operatorname{range} T$ 。因此 $\operatorname{range} T$ 对标量乘法封闭
我们已经证明了 range $T$ 包含 0 , 并且对加法和标量乘法都封闭, 故 range $T$ 是 $W$ 的子空间（由于 1.34）。

### 3.20 定义 满的（surjective）

如果函数 $T: V \rightarrow W$ 的值域等于 $W$ ，则称 $T$ 为满的.
为了解释上述定义，注意到在 3.18 中计算过其值域的那些线性映射，只有微分映射是满的（除了零映射在 $W=\{0\}$ 的特殊情形下是满的之外）。

线性映射是不是满的与其映到哪个向量空间有关。

许多数学家采用映上这个术语，意思与满的相同。
3.21 例 定义为 $D p=p^{\prime}$ 的微分映射 $D \in \mathcal{L}\left(\mathcal{P}_{5}(\mathbf{R}), \mathcal{P}_{5}(\mathbf{R})\right)$ 不是满的, 因为多项式 $x^{5}$ 不包含于 $T$ 的值域。然而，定义为 $S p=p^{\prime}$ 微分映射 $S \in \mathcal{L}\left(\mathcal{P}_{5}(\mathbf{R}), \mathcal{P}_{4}(\mathbf{R})\right)$ 是满的，因为其值域等于 $\mathcal{P}_{4}(\mathbf{R})$ ，它就是 $S$ 映到的向量空间。

## 线性映射基本定理

下面的结果非常重要，所以它有一个引人注目的名字.

### 3.22 线性映射基本定理

设 $V$ 是有限维的， $T \in \mathcal{L}(V, W)$. 则 range $T$ 是有限维的并且

$$
\operatorname{dim} V=\operatorname{dim} \operatorname{null} T+\operatorname{dim} \operatorname{range} T \text {. }
$$

证明 设 $u_{1}, \ldots, u_{m}$ 是 null $T$ 的基，则 $\operatorname{dim} \operatorname{null} T=m$ ，且线性无关组 $u_{1}, \ldots, u_{m}$ 可以扩充成 $V$ 的基 $u_{1}, \ldots, u_{m}, v_{1}, \ldots, v_{n}$ （由于 2.33）。于是 $\operatorname{dim} V=m+n$ 。为完成证明，只需证明 range $T$ 是有限维的，并且 $\operatorname{dim} \operatorname{range} T=n$ 。为此，往证 $T v_{1}, \ldots, T v_{n}$是 range $T$ 的基。

设 $v \in V$. 因为 $u_{1}, \ldots, u_{m}, v_{1}, \ldots, v_{n}$ 张成 $V$ ，所以

$$
v=a_{1} u_{1}+\cdots+a_{m} u_{m}+b_{1} v_{1}+\cdots+b_{n} v_{n}
$$

其中的这些 $a$ 和 $b$ 都含于 $\mathbf{F}$ 。用 $T$ 作用上式两端可得

$$
T v=b_{1} T v_{1}+\cdots+b_{n} T v_{n}
$$

其中没有出现形如 $T u_{j}$ 的项，这是因为每个 $u_{j} \in \operatorname{null} T$ 。上式表明 $T v_{1}, \ldots, T v_{n}$ 张成 range $T$ 。特别地，range $T$ 是有限维的。

为了证明 $T v_{1}, \ldots, T v_{n}$ 是线性无关的，设 $c_{1}, \ldots, c_{n} \in \mathbf{F}$ 并且

$$
c_{1} T v_{1}+\cdots+c_{n} T v_{n}=0
$$

那么

$$
T\left(c_{1} v_{1}+\cdots+c_{n} v_{n}\right)=0
$$

因此

$$
c_{1} v_{1}+\cdots+c_{n} v_{n} \in \operatorname{null} T
$$

由于 $u_{1}, \ldots, u_{m}$ 张成 null $T$ ，我们有

$$
c_{1} v_{1}+\cdots+c_{n} v_{n}=d_{1} u_{1}+\cdots+d_{m} u_{m}
$$

其中的这些 $d$ 都含于 $\mathbf{F}$ 。这个等式表明，所有的 $c$ （和 $d$ ）都是 0 （因为 $u_{1}, \ldots, u_{m}$, $v_{1}, \ldots, v_{n}$ 线性无关）。是 $T v_{1}, \ldots, T v_{n}$ 是线性无关的，故为 $\operatorname{range} T$ 的基。

现在我们可以证明，从一个有限维向量空间到更小的向量空间的线性映射不可能是单的, 这里 "更小"是用维数来衡量的.

### 3.23 到更小维数向量空间的线性映射不是单的

如果 $V$ 和 $W$ 都是有限维向量空间，并且 $\operatorname{dim} V>\operatorname{dim} W$ ，那么 $V$ 到 $W$ 的线性映射一定不是单的。

证明 设 $T \in \mathcal{L}(V, W)$. 则

$$
\begin{aligned}
\operatorname{dim} \operatorname{null} T & =\operatorname{dim} V-\operatorname{dim} \operatorname{range} T \\
& \geq \operatorname{dim} V-\operatorname{dim} W \\
& >0
\end{aligned}
$$

其中等号成立是由于线性映射基本定理 3.22. 上述不等式表明 $\operatorname{dim} \operatorname{null} T>0$ 。这意味着 null $T$ 包含非零向量. 因此 $T$ 不是单的（由于 3.16）。

下面的命题表明从一个有限维向量空间到更大的向量空间的线性映射不可能是满的，这里"更大"是用维数来衡量的.

### 3.24 到更大维数向量空间的线性映射不是满的

如果 $V$ 和 $W$ 都是有限维向量空间，并且 $\operatorname{dim} V<\operatorname{dim} W$ ，那么 $V$ 到 $W$ 的线性映射一定不是满的。

证明 设 $T \in \mathcal{L}(V, W)$. 则由线性映射基本定理 3.22 可得

$$
\begin{aligned}
\operatorname{dim} \operatorname{range} T & =\operatorname{dim} V-\operatorname{dim} \operatorname{null} T \\
& \leq \operatorname{dim} V \\
& <\operatorname{dim} W
\end{aligned}
$$

上述不等式表明 $\operatorname{dim} \operatorname{range} T<\operatorname{dim} W$ 。这意味着 null $T$ 不等于 $W$ 。因此 $T$ 不是满的.

我们马上就会看到 3.23 和 3.24 在线性方程组的理论中有重要的应用，其想法是用线性映射来表述线性方程组的问题。
3.25 例 用线性映射重述齐次线性方程组是否有非零解的问题。

解 取定正整数 $m$ 和 $n$ ，设 $A_{j, k} \in \mathbf{F}$ （其中 $j=1, \ldots, m, k=1, \ldots, n)$ 。考虑齐次线性方程

这里齐次的意思是每个方程右端的常数项都等于 0 .

组

$$
\left\{\begin{array}{c}
\sum_{k=1}^{n} A_{1, k} x_{k}=0 \\
\vdots \\
\sum_{k=1}^{n} A_{m, k} x_{k}=0
\end{array}\right.
$$

显然 $x_{1}=\cdots=x_{n}=0$ 是上述方程组的一个解. 问题是, 是否还有其他解.
定义 $T: \mathbf{F}^{n} \rightarrow \mathbf{F}^{m}$ 如下:

$$
T\left(x_{1}, \ldots, x_{n}\right)=\left(\sum_{k=1}^{n} A_{1, k} x_{k}, \ldots, \sum_{k=1}^{n} A_{m, k} x_{k}\right) .
$$

方程 $T\left(x_{1}, \ldots, x_{n}\right)=0$ （其中 0 是 $\mathbf{F}^{m}$ 的加法单位元，即，由 0 组成的长度为 $m$ 的组）与上述齐次线性方程组是一样的。

我们想知道 null $T$ 是否严格大于 $\{0\}$ 。 也就是说，可以将上述方程是否有非零解的问题重新陈述如下（由 3.16）：在什么条件下 $T$ 不是单的？

### 3.26 齐次线性方程组

当变量多于方程时，齐次线性方程组必有非零解。
证明 使用上面例子中的记号和结果。那么 $T$ 是 $\mathbf{F}^{n}$ 到 $\mathbf{F}^{m}$ 的线性映射，并且我们有含有 $n$ 个变量 $x_{1}, \ldots, x_{n}$ 和 $m$ 个方程的齐次线性方程组。由 3.23 可知, 若 $n>m$ 则 $T$ 不是单的。

上述命题的一个例子：含有 5 个变量和 4 个方程的齐次线性方程组必有非零解。
3.27 例 考虑是否可以选取常数项使得非齐次线性方程组无解的问题，并用线性映射重述这一问题。

解 取定正整数 $m$ 和 $n$ ，设 $A_{j, k} \in \mathbf{F}$ （其中 $j=1, \ldots, m, k=1, \ldots, n$ ）。对于 $c_{1}, \ldots, c_{m} \in \mathbf{F}$, 考虑线性方程组
3.28

$$
\left\{\begin{array}{c}
\sum_{k=1}^{n} A_{1, k} x_{k}=c_{1} \\
\vdots \\
\sum_{k=1}^{n} A_{m, k} x_{k}=c_{m}
\end{array}\right.
$$

现在的问题是，是否存在某些常数 $c_{1}, \ldots, c_{m} \in \mathbf{F}$ 使得上述方程组无解。
定义 $T: \mathbf{F}^{n} \rightarrow \mathbf{F}^{m}$ 如下：

$$
T\left(x_{1}, \ldots, x_{n}\right)=\left(\sum_{k=1}^{n} A_{1, k} x_{k}, \ldots, \sum_{k=1}^{n} A_{m, k} x_{k}\right)
$$

方程 $T\left(x_{1}, \ldots, x_{n}\right)=\left(c_{1}, \ldots, c_{m}\right)$ 与方程组 3.28 是一样的. 于是我们想知道是否 range $T \neq \mathbf{F}^{m}$ 。因此, 是否有常数 $c_{1}, \ldots, c_{m} \in \mathbf{F}$ 使得方程组无解的问题可重述为:在什么条件下 $T$ 不是满的？

### 3.29 非齐次线性方程组

当方程多于变量时，必有一组常数项使得相应的非齐次线性方程组无解.

变量多于方程的齐次线性方程组和方程多于变量的非齐次线性方程组的这些结果（3.26和3.29）通常都是用高斯消元法来证明的. 这里采用的抽象处理方法使证明更简洁。

证明 使用上面例子中的记号和结果。那么 $T$ 是 $\mathbf{F}^{n}$ 到 $\mathbf{F}^{m}$ 的线性映射，并且我们有含有 $n$ 个变量 $x_{1}, \ldots, x_{n}$ 和 $m$ 个方程的方程组。由3.24可知，若 $n<m$ 则 $T$ 不是满的。

上述命题的一个例子：对于含有 4 个变量和 5 个方程的非齐次线性方程组，可以选取某些常数项使方程组无解。

## 习题 3.B

1 给出线性映射 $T$ 使得 $\operatorname{dim} \operatorname{null} T=3$ 且 $\operatorname{dim} \operatorname{range} T=2$.
2 设 $V$ 是向量空间， $S, T \in \mathcal{L}(V, V)$ 使得 range $S \subset$ null $T$ 。证明 $(S T)^{2}=0$.
3 设 $v_{1}, \ldots, v_{m}$ 是 $V$ 中的向量组. 定义 $T \in \mathcal{L}\left(\mathbf{F}^{m}, V\right)$ 如下:

$$
T\left(z_{1}, \ldots, z_{m}\right)=z_{1} v_{1}+\cdots+z_{m} v_{m}
$$

（a） $T$ 的什么性质相当于 $v_{1}, \ldots, v_{m}$ 张成 $V$ ?
（b） $T$ 的什么性质相当于 $v_{1}, \ldots, v_{m}$ 是线性无关的？
4 证明 $\left\{T \in \mathcal{L}\left(\mathbf{R}^{5}, \mathbf{R}^{4}\right): \operatorname{dim} \operatorname{null} T>2\right\}$ 不是 $\mathcal{L}\left(\mathbf{R}^{5}, \mathbf{R}^{4}\right)$ 的子空间。
$\mathbf{5}$ 给出线性映射 $T: \mathbf{R}^{4} \rightarrow \mathbf{R}^{4}$ 使得 $\operatorname{range} T=\operatorname{null} T$ 。
6 证明不存在线性映射 $T: \mathbf{R}^{5} \rightarrow \mathbf{R}^{5}$ 使得 range $T=\operatorname{null} T$.
7 设 $V$ 和 $W$ 都是有限维的，且 $2 \leq \operatorname{dim} V \leq \operatorname{dim} W$ 。证明 $\{T \in \mathcal{L}(V, W)$ ： $T$ 不是单的 $\}$ 不是 $\mathcal{L}(V, W)$ 的子空间。

8 设 $V$ 和 $W$ 都是有限维的，且 $\operatorname{dim} V \geq \operatorname{dim} W \geq 2$ 。证明 $\{T \in \mathcal{L}(V, W)$ : $T$ 不是满的 $\}$ 不是 $\mathcal{L}(V, W)$ 的子空间。
9 设 $T \in \mathcal{L}(V, W)$ 是单的， $v_{1}, \ldots, v_{n}$ 在 $V$ 中线性无关。证明 $T v_{1}, \ldots, T v_{n}$ 在 $W$ 中线性无关。
10 设 $v_{1}, \ldots, v_{n}$ 张成 $V$ ，并设 $T \in \mathcal{L}(V, W)$ 。证明组 $T v_{1}, \ldots, T v_{n}$ 张成 range $T$ 。
11 设 $S_{1}, \ldots, S_{n}$ 均为单的线性映射且 $S_{1} S_{2} \cdots S_{n}$ 有意义。证明 $S_{1} S_{2} \cdots S_{n}$ 是单射.
12 设 $V$ 是有限维的， $T \in \mathcal{L}(V, W)$ 。证明 $V$ 有一个子空间 $U$ 使得 $U \cap \operatorname{null} T=\{0\}$且 range $T=\{T u: u \in U\}$ 。
13 设 $T$ 是从 $\mathbf{F}^{4}$ 到 $\mathbf{F}^{2}$ 的线性映射使得 null $T=\left\{\left(x_{1}, x_{2}, x_{3}, x_{4}\right) \in \mathbf{F}^{4}: x_{1}=\right.$ $\left.5 x_{2}, x_{3}=7 x_{4}\right\}$ 。证明 $T$ 是满的。
14 设 $U$ 是 $\mathbf{R}^{8}$ 的一个 3 维子空间， $T$ 是 $\mathbf{R}^{8}$ 到 $\mathbf{R}^{5}$ 的一个线性映射使得 $\mathrm{null} T=U$.证明 $T$ 是满的。

15 证明不存在零空间等于 $\left\{\left(x_{1}, x_{2}, x_{3}, x_{4}, x_{5}\right) \in \mathbf{F}^{5}: x_{1}=3 x_{2}, x_{3}=x_{4}=x_{5}\right\}$ 的 $\mathbf{F}^{5}$到 $\mathbf{F}^{2}$ 的线性映射。

16 假设在 $V$ 上存在一个线性映射，其零空间和值域都是有限维的。证明 $V$ 是有限维的。
17 设 $V$ 和 $W$ 都是有限维的。证明存在一个 $V$ 到 $W$ 的单的线性映射当且仅当 $\operatorname{dim} V \leq \operatorname{dim} W$.

18 设 $V$ 和 $W$ 都是有限维的。证明存在一个 $V$ 到 $W$ 的满的线性映射当且仅当 $\operatorname{dim} V \geq \operatorname{dim} W$ 。
19 设 $V$ 和 $W$ 都是有限维的，且 $U$ 是 $V$ 的子空间。证明存在 $T \in \mathcal{L}(V, W)$ 使得 null $T=U$ 当且仅当 $\operatorname{dim} U \geq \operatorname{dim} V-\operatorname{dim} W$.
20 设 $W$ 是有限维的， $T \in \mathcal{L}(V, W)$ 。证明 $T$ 是单的当且仅当存在 $S \in \mathcal{L}(W, V)$ 使得 $S T$ 是 $V$ 上的恒等映射。
21 设 $V$ 是有限维的， $T \in \mathcal{L}(V, W)$ 。证明 $T$ 是满的当且仅当存在 $S \in \mathcal{L}(W, V)$ 使得 $T S$ 是 $W$ 上的恒等映射。
22 设 $U$ 和 $V$ 都是有限维的向量空间，并设 $S \in \mathcal{L}(V, W), T \in \mathcal{L}(U, V)$. 证明

$$
\operatorname{dim} \text { null } S T \leq \operatorname{dim} \operatorname{null} S+\operatorname{dim} \operatorname{null} T
$$

23 设 $U$ 和 $V$ 都是有限维的向量空间，并设 $S \in \mathcal{L}(V, W), T \in \mathcal{L}(U, V)$. 证明

$$
\operatorname{dim} \operatorname{range} S T \leq \min \{\operatorname{dim} \operatorname{range} S \text {, dim range } T\} \text {. }
$$

24 设 $W$ 是有限维的，并设 $T_{1}, T_{2} \in \mathcal{L}(V, W)$ 。证明 null $T_{1} \subset$ null $T_{2}$ 当且仅当存在 $S \in \mathcal{L}(W, W)$ 使得 $T_{2}=S T_{1}$ 。
25 设 $V$ 是有限维的，并设 $T_{1}, T_{2} \in \mathcal{L}(V, W)$ 。证明 range $T_{1} \subset \operatorname{range} T_{2}$ 当且仅当存在 $S \in \mathcal{L}(V, V)$ 使得 $T_{1}=T_{2} S$ 。
26 设 $D \in \mathcal{L}(\mathcal{P}(\mathbf{R}), \mathcal{P}(\mathbf{R}))$ 使得对每个非常数多项式 $p \in \mathcal{P}(\mathbf{R})$ 均有 $\operatorname{deg} D p=$ $(\operatorname{deg} p)-1$ 。证明 $D$ 是满的。
这里采用 $D$ 这个记号是想让你联想到微分映射，它将 $p$ 变为 $p^{\prime}$ 。即使不知道多项式的求导公式（但知道它将多项式的次数降低 1 次），我们也可以使用这个习题来证明，对于每个多项式 $q \in \mathcal{P}(\mathbf{R})$ ，均存在多项式 $p \in \mathcal{P}(\mathbf{R})$ 使得 $p^{\prime}=q$ 。
27 设 $p \in \mathcal{P}(\mathbf{R})$. 证明存在多项式 $q \in \mathcal{P}(\mathbf{R})$ 使得 $5 q^{\prime \prime}+3 q^{\prime}=p$.本题可以不用线性代数的知识来做，不过用线性代数的知识做更有意思。
28 设 $T \in \mathcal{L}(V, W)$ ，并设 $w_{1}, \ldots, w_{m}$ 是 range $T$ 的基。证明存在 $\varphi_{1}, \ldots, \varphi_{m} \in$ $\mathcal{L}(V, \mathbf{F})$ 使得对每个 $v \in V$ 均有 $T v=\varphi_{1}(v) w_{1}+\cdots+\varphi_{m}(v) w_{m}$.
29 设 $\varphi \in \mathcal{L}(V, \mathbf{F})$ 。假定 $u \in V$ 不属于 null $\varphi$ 。证明 $V=\operatorname{null} \varphi \oplus\{a u: a \in \mathbf{F}\}$ 。
30 设 $\varphi_{1}$ 和 $\varphi_{2}$ 都是 $V$ 到 $\mathbf{F}$ 的线性映射，且具有相同的零空间。证明存在常数 $c \in \mathbf{F}$使得 $\varphi_{1}=c \varphi_{2}$ 。
31 给出 $\mathbf{R}^{5}$ 到 $\mathbf{R}^{2}$ 的两个线性映射 $T_{1}$ 和 $T_{2}$ ，使得它们具有相同的零空间，但 $T_{1}$ 不是 $T_{2}$ 的标量倍。

## 3.C 矩阵

## 用矩阵表示线性映射

我们知道，若 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基，且 $T: V \rightarrow W$ 是线性的，则 $T v_{1}, \ldots, T v_{n}$的值确定了 $T$ 在 $V$ 的任意向量上的值（见3.5）。我们马上就会看到, 利用 $W$ 的基,矩阵可用以有效地记录这些 $T v_{j}$ 的值.
3.30 定义 矩阵（matrix）， $A_{j, k}$

设 $m$ 和 $n$ 都是正整数. $m \times n$ 矩阵 $A$ 是由 $\mathbf{F}$ 的元素构成的 $m$ 行 $n$ 列的矩形阵列:

$$
A=\left(\begin{array}{ccc}
A_{1,1} & \ldots & A_{1, n} \\
\vdots & & \vdots \\
A_{m, 1} & \ldots & A_{m, n}
\end{array}\right)
$$

记号 $A_{j, k}$ 表示位于 $A$ 的第 $j$ 行第 $k$ 列处的元素. 也就是说, 第一个下标代表行,第二个下标代表列。

因此 $A_{2,3}$ 表示位于矩阵 $A$ 的第 2 行第 3 列处的元素。
3.31 例 若 $A=\left(\begin{array}{ccc}8 & 4 & 5-3 i \\ 1 & 9 & 7\end{array}\right)$, 则 $A_{2,3}=7$.

下面是本节的一个关键定义:
3.32 定义 线性映射的矩阵（matrix of a linear map）， $\mathcal{M}(T)$

设 $T \in \mathcal{L}(V, W)$ ，并设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基， $w_{1}, \ldots, w_{m}$ 是 $W$ 的基。规定 $T$ 关于这些基的矩阵为 $m \times n$ 矩阵 $\mathcal{M}(T)$ ，其中 $A_{j, k}$ 满足

$$
T v_{k}=A_{1, k} w_{1}+\cdots+A_{m, k} w_{m}
$$

如果这些基不是上下文自明的，则采用记号 $\mathcal{M}\left(T,\left(v_{1}, \ldots, v_{n}\right),\left(w_{1}, \ldots, w_{m}\right)\right)$.
线性映射 $T \in \mathcal{L}(V, W)$ 的矩阵 $\mathcal{M}(T)$ 依赖于 $V$ 的基 $v_{1}, \ldots, v_{n}$ 与 $W$ 的基 $w_{1}, \ldots, w_{m}$ 以及 $T$. 然而, 基在上下文中应当是自明的, 因此通常将其从记号中省略掉.

为了记住如何从 $T$ 构造 $\mathcal{M}(T)$, 可以将定义域的基向量 $v_{1}, \ldots, v_{n}$ 横写在顶端，并将 $T$ 映到的那个向量空间的基向量 $w_{1}, \ldots, w_{m}$ 竖写在左侧, 如下所示:

$$
\mathcal{M}(T)=\begin{gathered}
\\
w_{1} \\
\vdots \\
w_{m}
\end{gathered}\left(\begin{array}{ccccc}
v_{1} & \ldots & v_{k} & \ldots & v_{n} \\
& & A_{1, k} & & \\
& & \vdots & & \\
& & & A_{m, k} &
\end{array}\right)
$$

把 $T v_{k}$ 写成 $w_{1}, \ldots, w_{m}$ 的线性组合: $T v_{k}=\sum_{j=1}^{m} A_{j, k} w_{j}$, 其中的这些系数就组成了 $\mathcal{M}(T)$ 的第 $k$ 列。

如果 $T$ 是从 $n$ 维向量空间到 $m$维向量空间的一个线性映射，则 $\mathcal{M}(T)$ 是一个 $m \times n$ 矩阵。

在上面的矩阵中, 只列出了第 $k$ 列, 因此所列出的这些元素的第二个下标都是 $k$ 。上图会让我们想到， $T v_{k}$ 也可以从矩阵 $\mathcal{M}(T)$ 计算出来：将矩阵的第 $k$ 列的每个元素与左侧的列中相应的 $w$ 相乘，然后再将所得向量相加。

如果 $T$ 是 $\mathbf{F}^{n}$ 到 $\mathbf{F}^{m}$ 的线性映射，那么除非特殊说明，总设所考虑的基是标准基（其中第 $k$ 个基向量的第 $k$ 个位置是 1 ，其他位置都是 0）。如果把 $\mathbf{F}^{m}$ 中的元素看成由 $m$ 个数组成的列，那么可以把 $\mathcal{M}(T)$ 的第 $k$ 列视为 $T$ 对第 $k$ 个标准基向量的作用。
3.33 例 设 $T \in \mathcal{L}\left(\mathbf{F}^{2}, \mathbf{F}^{3}\right)$ 定义如下:

$$
T(x, y)=(x+3 y, 2 x+5 y, 7 x+9 y)
$$

求 $T$ 关于 $\mathbf{F}^{2}$ 和 $\mathbf{F}^{3}$ 的标准基的矩阵。
解 由于 $T(1,0)=(1,2,7), T(0,1)=(3,5,9)$, 所以 $T$ 关于标准基的 $3 \times 2$ 矩阵如下:

$$
\mathcal{M}(T)=\left(\begin{array}{ll}
1 & 3 \\
2 & 5 \\
7 & 9
\end{array}\right)
$$

在考虑 $\mathcal{P}_{m}(\mathbf{F})$ 时, 除非特别声明, 总使用标准基 $1, x, x^{2}, \ldots, x^{m}$.
3.34 例 设 $D \in \mathcal{L}\left(\mathcal{P}_{3}(\mathbf{R}), \mathcal{P}_{2}(\mathbf{R})\right)$ 是微分映射 $D p=p^{\prime}$ 。 求 $D$ 关于 $\mathcal{P}_{3}(\mathbf{R})$ 和 $\mathcal{P}_{2}(\mathbf{R})$的标准基的矩阵。

解 由于 $\left(x^{n}\right)^{\prime}=n x^{n-1}$, 所以 $D$ 关于标准基的 $3 \times 4$ 矩阵如下:

$$
\mathcal{M}(D)=\left(\begin{array}{llll}
0 & 1 & 0 & 0 \\
0 & 0 & 2 & 0 \\
0 & 0 & 0 & 3
\end{array}\right)
$$

## 矩阵的加法与标量乘法

在本节的余下部分，总假定 $V$ 和 $W$ 是有限维的且已取定 $V$ 和 $W$ 的基。则对于每个从 $V$ 到 $W$ 的线性映射，我们都可以谈论它的矩阵（当然，是关于这些取定的基的）。两个线性映射之和的矩阵是否等于这两个映射的矩阵之和呢？

这个问题现在还没有意义，这是因为，尽管我们定义了两个线性映射的和，但是还没有定义两个矩阵的和。幸好矩阵的和有明显的定义，而且此定义恰好就有这样的性质。具体地，我们有如下定义。

### 3.35 定义 矩阵加法（matrix addition）

规定两个同样大小的矩阵的和是把矩阵中相对应的元素相加得到的矩阵:

$$
\begin{aligned}
&\left(\begin{array}{ccc}
A_{1,1} & \ldots & A_{1, n} \\
\vdots & & \vdots \\
A_{m, 1} & \ldots & A_{m, n}
\end{array}\right)+\left(\begin{array}{ccc}
C_{1,1} & \ldots & C_{1, n} \\
\vdots & & \vdots \\
C_{m, 1} & \ldots & C_{m, n}
\end{array}\right) \\
&=\left(\begin{array}{ccc}
A_{1,1}+C_{1,1} & \ldots & A_{1, n}+C_{1, n} \\
\vdots & & \vdots \\
A_{m, 1}+C_{m, 1} & \ldots & A_{m, n}+C_{m, n}
\end{array}\right)
\end{aligned}
$$

也就是说， $(A+C)_{j, k}=A_{j, k}+C_{j, k}$.
在下面命题中，假设所有三个线性映射 $S+T 、 S 、 T$ 都使用同样的基.

### 3.36 线性映射的和的矩阵

设 $S, T \in \mathcal{L}(V, W)$, 则 $\mathcal{M}(S+T)=\mathcal{M}(S)+\mathcal{M}(T)$.
上述结果的证明留给读者。
仍然假设我们已经取定了某些基, 标量与线性映射之积的矩阵是否等于标量与线性映射的矩阵之积？这个问题现在还没有意义，这是因为我们还没有定义矩阵的标量乘法. 幸好矩阵的标量乘法有明显的定义，而且此定义恰好就有这样的性质。

### 3.37 定义 矩阵的标量乘法（scalar multiplication of a matrix）

标量与矩阵的乘积就是用该标量乘以矩阵的每个元素：

$$
\lambda\left(\begin{array}{ccc}
A_{1,1} & \ldots & A_{1, n} \\
\vdots & & \vdots \\
A_{m, 1} & \ldots & A_{m, n}
\end{array}\right)=\left(\begin{array}{ccc}
\lambda A_{1,1} & \ldots & \lambda A_{1, n} \\
\vdots & & \vdots \\
\lambda A_{m, 1} & \ldots & \lambda A_{m, n}
\end{array}\right) .
$$

也就是说， $(\lambda A)_{j, k}=\lambda A_{j, k}$.
在下面命题中，假设线性映射 $\lambda T$ 和 $T$ 使用相同的基.

### 3.38 标量乘以线性映射的矩阵

设 $\lambda \in \mathbf{F}, T \in \mathcal{L}(V, W)$ ，则 $\mathcal{M}(\lambda T)=\lambda \mathcal{M}(T)$.
这一结果的证明也留给读者。
由于已经定义了矩阵的加法和标量乘法，由此产生一个向量空间就不足为奇了，只需一个记号来表示这个新的向量空间。

### 3.39 记号 $\mathbf{F}^{m, n}$

对于正整数 $m$ 和 $n$, 元素取自 $\mathbf{F}$ 的所有 $m \times n$ 矩阵的集合记为 $\mathbf{F}^{m, n}$.
$3.40 \operatorname{dim} \mathbf{F}^{m, n}=m n$
设 $m$ 和 $n$ 均为正整数. 按照上面定义的矩阵加法和标量乘法, $\mathbf{F}^{m, n}$ 是 $m n$ 维向量空间。

证明 证明 $\mathbf{F}^{m, n}$ 是向量空间留给读者。注意 $\mathbf{F}^{m, n}$ 的加法单位元是元素均为 0 的 $m \times n$ 矩阵。

读者还应该证明某个位置为 1 其余元素均为 0 的全体 $m \times n$ 矩阵构成 $\mathbf{F}^{m, n}$ 的基. 共有 $m n$ 个这样的矩阵, 所以 $\mathbf{F}^{m, n}$ 的维数等于 $m n$.

## 矩阵乘法

如前，设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基， $w_{1}, \ldots, w_{m}$ 是 $W$ 的基，并设 $U$ 是另一个向量空间， $u_{1}, \ldots, u_{p}$ 是 $U$ 的基。

考虑线性映射 $T: U \rightarrow V$ 和 $S: V \rightarrow W$ ，它们的复合映射 $S T$ 是从 $U$ 到 $W$ 的线性映射。 $\mathcal{M}(S T)$ 是否等于 $\mathcal{M}(S) \mathcal{M}(T)$ ？这个问题没有意义，因为还没有定义矩阵乘法. 我们要定义一种矩阵乘法使上述问题有肯定的回答. 现在来看看该怎么做.

设 $\mathcal{M}(S)=A, \mathcal{M}(T)=C$ 。对于 $1 \leq k \leq p$ 我们有

$$
\begin{aligned}
(S T) u_{k} & =S\left(\sum_{r=1}^{n} C_{r, k} v_{r}\right) \\
& =\sum_{r=1}^{n} C_{r, k} S v_{r} \\
& =\sum_{r=1}^{n} C_{r, k} \sum_{j=1}^{m} A_{j, r} w_{j} \\
& =\sum_{j=1}^{m}\left(\sum_{r=1}^{n} A_{j, r} C_{r, k}\right) w_{j} .
\end{aligned}
$$

因此 $\mathcal{M}(S T)$ 是 $m \times p$ 矩阵, 它的第 $j$ 行第 $k$ 列元素等于

$$
\sum_{r=1}^{n} A_{j, r} C_{r, k}
$$

现在来看看如何定义矩阵的乘法以使 $\mathcal{M}(S T)=\mathcal{M}(S) \mathcal{M}(T)$ 成立.

### 3.41 定义 矩阵乘法（matrix multiplication）

设 $A$ 是 $m \times n$ 矩阵， $C$ 是 $n \times p$ 矩阵。 $A C$ 定义为 $m \times p$ 矩阵，其第 $j$ 行第 $k$ 列元素是

$$
(A C)_{j, k}=\sum_{r=1}^{n} A_{j, r} C_{r, k}
$$

也就是说，把 $A$ 的第 $j$ 行与 $C$ 的第 $k$ 列的对应元素相乘再求和，就得到 $A C$ 的第 $j$ 行第 $k$ 列元素。

注意，只有当第一个矩阵的列数等于第二个矩阵的行数时，我们才能定义这两个矩阵的乘积。

你可能在以前的课程中已经学过矩阵乘法的定义，尽管当时你可能还不知道这么做的缘由。
3.42 例 现在我们把一个 $3 \times 2$ 矩阵与一个 $2 \times 4$ 矩阵相乘, 得到一个 $3 \times 4$ 矩阵：

$$
\left(\begin{array}{cc}
1 & 2 \\
3 & 4 \\
5 & 6
\end{array}\right)\left(\begin{array}{cccc}
6 & 5 & 4 & 3 \\
2 & 1 & 0 & -1
\end{array}\right)=\left(\begin{array}{cccc}
10 & 7 & 4 & 1 \\
26 & 19 & 12 & 5 \\
42 & 31 & 20 & 9
\end{array}\right)
$$

矩阵的乘法不满足交换律. 也就是说 $A C$ 未必等于 $C A$, 即使两个乘积都有意义 (见习题 12). 矩阵的乘法满足分配律和结合律（见习题 13 和习题 14）。

在下面的命题中，假设在考虑 $T \in \mathcal{L}(U, V)$ 和 $S \in \mathcal{L}(V, W)$ 时使用 $V$ 的同一基，在考虑 $S \in \mathcal{L}(V, W)$ 和 $S T \in \mathcal{L}(U, W)$ 时使用 $W$ 的同一基，在考虑 $T \in \mathcal{L}(U, V)$ 和 $S T \in \mathcal{L}(U, W)$ 时使用 $U$ 的同一基.

### 3.43 线性映射乘积的矩阵

若 $T \in \mathcal{L}(U, V), S \in \mathcal{L}(V, W)$, 则 $\mathcal{M}(S T)=\mathcal{M}(S) \mathcal{M}(T)$.
上述结果的证明就是在矩阵乘法定义之前解释缘由时所做的那些计算。
在下面的记号中，和前面一样，第一个下标代表行，第二个下标代表列，而小圆点 ‘’’代表占位符。
3.44 记号 $A_{j,,}, A_{\cdot, k}$

设 $A$ 是 $m \times n$ 矩阵。

- 若 $1 \leq j \leq m$ ，则 $A_{j}$ ，表示 $A$ 的第 $j$ 行组成的 $1 \times n$ 矩阵。
- 若 $1 \leq k \leq n$, 则 $A \cdot, k$ 表示 $A$ 的第 $k$ 列组成的 $m \times 1$ 矩阵.
3.45 例 若 $A=\left(\begin{array}{ccc}8 & 4 & 5 \\ 1 & 9 & 7\end{array}\right)$ ，则 $A_{2, .}$ 是 $A$ 的第 2 行，而 $A \cdot, 2$ 是 $A$ 的第 2 列。也就是说，

$$
A_{2, \cdot}=\left(\begin{array}{ccc}
1 & 9 & 7
\end{array}\right) \quad \text { 和 } \quad A_{\cdot, 2}=\binom{4}{9} .
$$

$1 \times n$ 矩阵与 $n \times 1$ 矩阵的乘积是 $1 \times 1$ 矩阵. 然而, 我们经常把 $1 \times 1$ 矩阵和它的元素看成是一样的。
3.46 例 $\left(\begin{array}{ll}3 & 4\end{array}\right)\binom{6}{2}=(26)$, 因为 $3 \cdot 6+4 \cdot 2=26$. 然而, 我们可以将 $(26)$ 和 26 看成是一样的, 写成 $\left(\begin{array}{ll}3 & 4\end{array}\right)\binom{6}{2}=26$.

下面的命题给出了理解矩阵乘法的另一种方式. $A C$ 的第 $j$ 行第 $k$ 列元素等于 $A$的第 $j$ 行乘以 $C$ 的第 $k$ 列。

### 3.47 矩阵乘积的元素等于行乘以列

设 $A$ 是 $m \times n$ 矩阵, $C$ 是 $n \times p$ 矩阵. 则对于 $1 \leq j \leq m$ 和 $1 \leq k \leq p$,

$$
(A C)_{j, k}=A_{j, \cdot} C_{\cdot, k}
$$

上述结果的证明由定义立得。
3.48 例 上述结果和例 3.46 说明了为什么例 3.42 中矩阵乘积的第 2 行第 1 列的元素等于 26 。

下面的命题给出了理解矩阵乘法的另一种方式：它是说 $A C$ 的第 $k$ 列等于 $A$ 乘以 $C$ 的第 $k$ 列。

### 3.49 矩阵乘积的列等于矩阵乘以列

设 $A$ 是 $m \times n$ 矩阵, $C$ 是 $n \times p$ 矩阵. 则对于 $1 \leq k \leq p$,

$$
(A C)_{\cdot, k}=A C_{\cdot, k}
$$

上述结果的证明依然可由定义立得，其证明留给读者。
3.50 例 利用上述结果以及等式

$$
\left(\begin{array}{ll}
1 & 2 \\
3 & 4 \\
5 & 6
\end{array}\right)\binom{5}{1}=\left(\begin{array}{c}
7 \\
19 \\
31
\end{array}\right)
$$

我们看到为什么 3.42 中矩阵乘积的第 2 列等于上式的右端。

再给出一种理解 $m \times n$ 矩阵与 $n \times 1$ 矩阵乘积的方式. 下例阐释了如何这样做.
3.51 例 在上面的例子中, $3 \times 2$ 矩阵与 $2 \times 1$ 矩阵的乘积是 $3 \times 2$ 矩阵的诸列的线性组合, 线性组合中的标量取自那个 $2 \times 1$ 矩阵. 具体来说,

$$
\left(\begin{array}{c}
7 \\
19 \\
31
\end{array}\right)=5\left(\begin{array}{c}
1 \\
3 \\
5
\end{array}\right)+1\left(\begin{array}{l}
2 \\
4 \\
6
\end{array}\right)
$$

下面的命题推广了上述例子，其证明还是可由定义立得，留给读者。

### 3.52 列的线性组合

设 $A$ 是 $m \times n$ 矩阵, $c=\left(\begin{array}{c}c_{1} \\ \vdots \\ c_{n}\end{array}\right)$ 是 $n \times 1$ 矩阵. 则

$$
A c=c_{1} A_{\cdot, 1}+\cdots+c_{n} A_{\cdot, n}
$$

也就是说, $A c$ 是 $A$ 的诸列的线性组合, 其中的标量来自 $c$.
习题 10 和习题 11 中还给出了理解矩阵乘法的另外两种方式.

## 习题 3.C

1 设 $V$ 和 $W$ 都是有限维的， $T \in \mathcal{L}(V, W)$ 。证明对于 $V$ 和 $W$ 的任意基， $T$ 的矩阵都至少有 $\operatorname{dim} \operatorname{range} T$ 个非零元。

2 设 $D \in \mathcal{L}\left(\mathcal{P}_{3}(\mathbf{R}), \mathcal{P}_{2}(\mathbf{R})\right)$ 是微分映射 $D p=p^{\prime}$ 。求 $\mathcal{P}_{3}(\mathbf{R})$ 的一个基和 $\mathcal{P}_{2}(\mathbf{R})$ 的一个基, 使得 $D$ 关于这些基的矩阵为

$$
\left(\begin{array}{llll}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0
\end{array}\right)
$$

请比较本题与例 3.34. 下题推广了本题。
3 设 $V$ 和 $W$ 都是有限维的， $T \in \mathcal{L}(V, W)$ 。证明存在 $V$ 的一个基和 $W$ 的一个基，使得关于这些基， $\mathcal{M}(T)$ 除了第 $j$ 行第 $j$ 列（ $1 \leq j \leq \operatorname{dim} \operatorname{range} T$ ）的元素等于 1以外，其余元素均为 0 。
4 设 $v_{1}, \ldots, v_{m}$ 是 $V$ 的基，且 $W$ 是有限维的。设 $T \in \mathcal{L}(V, W)$ 。证明存在 $W$ 的一个基 $w_{1}, \ldots, w_{n}$ 使得，在 $T$ 关于基 $v_{1}, \ldots, v_{m}$ 和 $w_{1}, \ldots, w_{n}$ 的矩阵 $\mathcal{M}(T)$ 中，除了第 1 行第 1 列处的元素可能为 1 之外, 第 1 列的其余元素均为 0 .
与习题 3 不同，本题给定了 $V$ 的一个基，而不是可以选取 $V$ 的一个基.
5 设 $w_{1}, \ldots, w_{n}$ 是 $W$ 的基，且 $V$ 是有限维的。设 $T \in \mathcal{L}(V, W)$ 。证明存在 $V$ 的一个基 $v_{1}, \ldots, v_{m}$ 使得，在 $T$ 关于基 $v_{1}, \ldots, v_{m}$ 和 $w_{1}, \ldots, w_{n}$ 的矩阵 $\mathcal{M}(T)$ 中，除了第 1 行第 1 列处的元素可能为 1 之外, 第 1 行的其余元素均为 0 .
与习题 3 不同，本题给定了 $W$ 的一个基，而不是可以选取 $W$ 的一个基。
6 设 $V$ 和 $W$ 都是有限维的， $T \in \mathcal{L}(V, W)$ 。证明 $\operatorname{dim} \operatorname{range} T=1$ 当且仅当 $V$ 和 $W$各有一个基使得关于这些基 $\mathcal{M}(T)$ 的所有元素都等于 1 .

7 验证 3.36.
8 验证 3.38.
9 证明 3.52 。
10 设 $A$ 是 $m \times n$ 矩阵， $C$ 是 $n \times p$ 矩阵。证明对于 $1 \leq j \leq m$,

$$
(A C)_{j,}=A_{j,} C
$$

也就是说，证明 $A C$ 的第 $j$ 行等于 $A$ 的第 $j$ 行乘以 $C$.
11 设 $a=\left(\begin{array}{lll}a_{1} & \cdots & a_{n}\end{array}\right)$ 是 $1 \times n$ 矩阵， $C$ 是 $n \times p$ 矩阵。证明

$$
a C=a_{1} C_{1, \cdot}+\cdots+a_{n} C_{n, \cdot}
$$

也就是说，证明 $a C$ 是 $C$ 的诸行的线性组合，其中的标量来自 $a$.
12 举一个 $2 \times 2$ 矩阵的例子，说明矩阵乘法不是交换的。 也就是说，找两个 $2 \times 2$ 矩阵 $A$ 和 $C$ 使得 $A C \neq C A$ 。
13 证明矩阵的加法和乘法满足分配性质。换言之，设 $A 、 B 、 C 、 D 、 E 、 F$ 均为矩阵，且其大小使 $A(B+C)$ 和 $(D+E) F$ 都有意义。证明: $A B+A C$ 和 $D F+E F$都有意义, 而且我们有 $A(B+C)=A B+A C$ 且 $(D+E) F=D F+E F$.

14 证明矩阵乘法是结合的. 也就是说，设 $A 、 B 、 C$ 是适当大小的矩阵使得 $(A B) C$有意义。证明 $A(B C)$ 有意义且 $(A B) C=A(B C)$.
15 设 $A$ 是 $n \times n$ 矩阵， $1 \leq j, k \leq n$ 。证明 $A^{3}$ （即 $A A A$ ）的第 $j$ 行第 $k$ 列的元素为

$$
\sum_{p=1}^{n} \sum_{r=1}^{n} A_{j, p} A_{p, r} A_{r, k}
$$

## 3.D 可逆性与同构的向量空间

## 可逆的线性映射

我们先定义线性映射的可逆及逆.
3.53 定义 可逆（invertible）、逆（inverse）

- 线性映射 $T \in \mathcal{L}(V, W)$ 称为可逆的, 如果存在线性映射 $S \in \mathcal{L}(W, V)$ 使得 $S T$ 等于 $V$ 上的恒等映射且 $T S$ 等于 $W$ 上的恒等映射。
- 满足 $S T=I$ 和 $T S=I$ 的线性映射 $S \in \mathcal{L}(W, V)$ 称为 $T$ 的逆（注意，第一个 $I$ 是 $V$ 上的恒等映射, 第二个 $I$ 是 $W$ 上的恒等映射).


### 3.54 逆是唯一的

可逆的线性映射有唯一的逆.
证明 设 $T \in \mathcal{L}(V, W)$ 可逆，且 $S_{1}$ 和 $S_{2}$ 均为 $T$ 的逆. 则

$$
S_{1}=S_{1} I=S_{1}\left(T S_{2}\right)=\left(S_{1} T\right) S_{2}=I S_{2}=S_{2}
$$

于是 $S_{1}=S_{2}$.
既然知道逆是唯一的，我们可以给它一个记号。
3.55 记号 $T^{-1}$

若 $T$ 可逆, 则它的逆记为 $T^{-1}$. 也就是说, 如果 $T \in \mathcal{L}(V, W)$ 可逆, 则 $T^{-1}$ 是 $\mathcal{L}(W, V)$ 中唯一一个使得 $T^{-1} T=I$ 且 $T T^{-1}=I$ 的元素。

下面的命题刻画了可逆线性映射。

### 3.56 可逆性等价于单性和满性

一个线性映射是可逆的当且仅当它既是单的又是满的.
证明 设 $T \in \mathcal{L}(V, W)$. 我们需要证明, $T$ 是可逆的当且仅当它既是单的又是满的.
首先假设 $T$ 是可逆的. 为了证明 $T$ 是单的, 设 $u, v \in V$ 且 $T u=T v$. 则

$$
u=T^{-1}(T u)=T^{-1}(T v)=v
$$

所以 $u=v$. 因此 $T$ 是单的.
仍设 $T$ 是可逆的. 现在证明 $T$ 是满的. 为此, 设 $w \in W$, 那么 $w=T\left(T^{-1} w\right)$,这表明 $w$ 含于 $T$ 的值域。于是 range $T=W$ ，所以 $T$ 是满的。这就完成了证明的一个方向。

现在假设 $T$ 既是单的又是满的。我们需要证明 $T$ 是可逆的。对于每个 $w \in W$,定义 $S w$ 是 $V$ 中唯一使得 $T(S w)=w$ 的那个元素（由 $T$ 既单又满可得此元素的存在性和唯一性）。显然， $T \circ S$ 等于 $W$ 上的恒等映射。

为了证明 $S \circ T$ 等于 $V$ 上的恒等映射, 设 $v \in V$, 则

$$
T((S \circ T) v)=(T \circ S)(T v)=I(T v)=T v
$$

这个等式表明（ $S \circ T) v=v$ （因为 $T$ 是单的），因此 $S \circ T$ 等于 $V$ 上的恒等映射。
为了完成证明，还需要证明 $S$ 是线性的。为此设 $w_{1}, w_{2} \in W$. 则

$$
T\left(S w_{1}+S w_{2}\right)=T\left(S w_{1}\right)+T\left(S w_{2}\right)=w_{1}+w_{2}
$$

于是， $S w_{1}+S w_{2}$ 是 $V$ 中唯一被 $T$ 映成 $w_{1}+w_{2}$ 的那个元素。再由 $S$ 的定义可得 $S\left(w_{1}+w_{2}\right)=S w_{1}+S w_{2}$ 。因此 $S$ 满足加性. 齐性的证明是类似的. 具体来说, 如果 $w \in W, \lambda \in \mathbf{F}$, 则

$$
T(\lambda S w)=\lambda T(S w)=\lambda w
$$

于是， $\lambda S w$ 是 $V$ 中唯一被 $T$ 映成 $\lambda w$ 的那个元素。再由 $S$ 的定义可得 $S(\lambda w)=\lambda S w$.因此 $S$ 是线性的.

### 3.57 例 不可逆的线性映射

- 从 $\mathcal{P}(\mathbf{R})$ 到 $\mathcal{P}(\mathbf{R})$ 的乘以 $x^{2}$ 线性映射（见 3.4）不可逆，因为它不是满的（1不在它的值域中)。
- 从 $\mathbf{F}^{\infty}$ 到 $\mathbf{F}^{\infty}$ 的向后移位线性映射（见3.4）不可逆，因为它不是单的（ $(1,0,0$, $0, \ldots)$ 含于零空间）。


## 同构的向量空间

下面的定义刻画了除元素的名字之外本质上相同的两个向量空间.

### 3.58 定义 同构（isomorphism）、同构的（isomorphic）

- 同构就是可逆的线性映射。
- 若两个向量空间之间存在一个同构, 则称这两个向量空间是同构的.

同构 $T: V \rightarrow W$ 把 $v \in V$ 重新标记为 $T v \in W$ 。这个观点解释了为什么两个同构的向量空间具有相同的性质。"同构"和"可逆的线性映射"这两个术语的意思相同。"同构"这个术语用以强调两个空间本质上相同。

在希腊语中，isos 的意思是 "相同", morph 的意思是 "形状". 因此，isomorphic的字面意思就是 "同形".

### 3.59 维数反映了向量空间是否同构

F 上两个有限维向量空间同构当且仅当其维数相同.
证明 设 $V$ 和 $W$ 是同构的有限维向量空间，则存在从 $V$ 到 $W$ 的同构 $T$ 。因为 $T$ 是可逆的，所以 null $T=\{0\}$ 且 range $T=W$ 。从而 $\operatorname{dimnull} T=0$ 且 $\operatorname{dim} \operatorname{range} T=$ $\operatorname{dim} W$ 。于是公式

$$
\operatorname{dim} V=\operatorname{dim} \operatorname{null} T+\operatorname{dim} \operatorname{range} T
$$

（线性映射基本定理 3.22）变成了等式 $\operatorname{dim} V=\operatorname{dim} W$ ，这就证明了一个方面.
为了证明另一个方面，假定 $V$ 和 $W$ 是维数相同的向量空间，设 $v_{1}, \ldots, v_{n}$ 是 $V$的基， $w_{1}, \ldots, w_{n}$ 是 $W$ 的基，设 $T \in \mathcal{L}(V, W)$ 定义如下：

$$
T\left(c_{1} v_{1}+\cdots+c_{n} v_{n}\right)=c_{1} w_{1}+\cdots+c_{n} w_{n}
$$

则 $T$ 是定义合理的线性映射，因为 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基（见3.5）。因为 $w_{1}, \ldots, w_{n}$ 张成 $W$ ，所以 $T$ 是满的。又因为 $w_{1}, \ldots, w_{n}$ 是线性无关的，所以 $\operatorname{null} T=\{0\}$ ，从而 $T$是单的。由于 $T$ 既单又满，从而是一个同构（见3.56）。因此 $V$ 与 $W$ 是同构的。

上面的定理表明，每个有限维向量空间都同构于 $\mathbf{F}^{n}$ ，其中 $n=\operatorname{dim} V$ 。如果 $v_{1}, \ldots, v_{n}$是 $V$ 的基， $w_{1}, \ldots, w_{m}$ 是 $W$ 的基，那么每个 $T \in \mathcal{L}(V, W)$ 都有一个矩阵 $\mathcal{M}(T) \in \mathbf{F}^{m, n}$ 。也就是说，一旦选定了 $V$ 和 $W$ 的基，那么 $\mathcal{M}$ 就是从 $\mathcal{L}(V, W)$ 到 $\mathbf{F}^{m, n}$ 的函数。注意， 3.36 和 3.38 表明 $\mathcal{M}$ 是线性映射。现在我们证明，这个线性映射实际上还是可逆的。

既然每个有限维向量空间都同构于某个 $\mathbf{F}^{n}$ ，那么为什么不只研究 $\mathbf{F}^{n}$而还要研究更一般的向量空间呢？为了回答这个问题，注意到 $\mathbf{F}^{n}$ 的研究立刻就会产生不等于 $\mathbf{F}^{n}$ 的向量空间。例如，我们会遇到线性映射的零空间和值域。尽管这些向量空间都分别同构于某个 $\mathbf{F}^{n}$ ，但是这样考虑问题往往只会增加复杂性而不会有新的见解。
$3.60 \mathcal{L}(V, W)$ 与 $\mathbf{F}^{m, n}$ 同构
设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基， $w_{1}, \ldots, w_{m}$ 是 $W$ 的基，则 $\mathcal{M}$ 是 $\mathcal{L}(V, W)$ 与 $\mathbf{F}^{m, n}$ 之间的一个同构。

证明 已知 $\mathcal{M}$ 是线性的，故只需证明 $\mathcal{M}$ 既单又满。这些都很容易. 先从单性开始.如果 $T \in \mathcal{L}(V, W)$ 并且 $\mathcal{M}(T)=0$ ，则 $T v_{k}=0, k=1, \ldots, n$ 。因为 $v_{1}, \ldots, v_{n}$ 是 $V$的基，所以 $T=0$ 。于是 $\mathcal{M}$ 是单的（由于 3.16 ）。

为了证明 $\mathcal{M}$ 是满的，设 $A \in \mathbf{F}^{m, n}$ 。设 $T$ 是从 $V$ 到 $W$ 的线性映射使得

$$
T v_{k}=\sum_{j=1}^{m} A_{j, k} w_{j}
$$

其中 $k=1, \ldots, n$ （见 3.5 ）。显然 $\mathcal{M}(T)$ 等于 $A$ ，所以 $\mathcal{M}$ 的值域等于 $\mathbf{F}^{m, n}$ 。
现在可以确定从一个向量空间到另一个向量空间的所有线性映射构成的向量空间的维数。
$3.61 \operatorname{dim} \mathcal{L}(V, W)=(\operatorname{dim} V)(\operatorname{dim} W)$
设 $V$ 和 $W$ 都是有限维的，则 $\mathcal{L}(V, W)$ 是有限维的且

$$
\operatorname{dim} \mathcal{L}(V, W)=(\operatorname{dim} V)(\operatorname{dim} W)
$$

证明 由 $3.60 、 3.59$ 和 3.40 证得。

## 将线性映射视为矩阵乘

前面定义了线性映射的矩阵. 现在来定义向量的矩阵.
3.62 定义 向量的矩阵（matrix of a vector）， $\mathcal{M}(v)$

设 $v \in V$ ，并设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基。则规定 $v$ 关于这个基的矩阵是 $n \times 1$ 矩阵

$$
\mathcal{M}(v)=\left(\begin{array}{c}
c_{1} \\
\vdots \\
c_{n}
\end{array}\right)
$$

这里 $c_{1}, \ldots, c_{n}$ 是使得下式成立的标量:

$$
v=c_{1} v_{1}+\cdots+c_{n} v_{n}
$$

向量 $v \in V$ 的矩阵 $\mathcal{M}(v)$ 与 $V$ 的基 $v_{1}, \ldots, v_{n}$ 有关，也与向量 $v$ 有关。然而，基通常是上下文自明的，所以就不把基包括在记号中了.

### 3.63 例 向量的矩阵

- $2-7 x+5 x^{3}$ 关于 $\mathcal{P}_{3}(\mathbf{R})$ 的标准基的矩阵为

$$
\left(\begin{array}{c}
2 \\
-7 \\
0 \\
5
\end{array}\right)
$$

- 向量 $x \in \mathbf{F}^{n}$ 关于标准基的矩阵就是以 $x$ 的坐标为元素而得到的 $n \times 1$ 矩阵.也就是说，若 $x=\left(x_{1}, \ldots, x_{n}\right) \in \mathbf{F}^{n}$ ，则

$$
\mathcal{M}(x)=\left(\begin{array}{c}
x_{1} \\
\vdots \\
x_{n}
\end{array}\right)
$$

有时我们想把 $V$ 中的元素视为 $n \times 1$ 矩阵。一旦选定了 $v_{1}, \ldots, v_{n}$ ，函数 $\mathcal{M}$ 将 $v \in V$ 变为 $\mathcal{M}(v)$ ，就是 $V$ 到 $\mathbf{F}^{n, 1}$ 的同构，这就实现了上述想法。

回想一下，若 $A$ 是 $m \times n$ 矩阵，则 $A_{\cdot, k}$ 表示 $A$ 的第 $k$ 列，看作一个 $m \times 1$ 矩阵. 下面的命题计算 $\mathcal{M}\left(T v_{k}\right)$ 关于 $W$ 的基 $w_{1}, \ldots, w_{m}$ 的矩阵。
$3.64 \mathcal{M}(T)_{,, k}=\mathcal{M}\left(T v_{k}\right)$.
设 $T \in \mathcal{L}(V, W), v_{1}, \ldots, v_{n}$ 是 $V$ 的基， $w_{1}, \ldots, w_{m}$ 是 $W$ 的基。设 $1 \leq k \leq n$.则 $\mathcal{M}(T)$ 的第 $k$ 列（记为 $\mathcal{M}(T), k)$ 等于 $\mathcal{M}\left(T v_{k}\right)$ 。

证明 由 $\mathcal{M}(T)$ 和 $\mathcal{M}\left(v_{k}\right)$ 的定义立得。
下面的命题表明线性映射的矩阵、向量的矩阵以及矩阵乘法是如何联系到一起的。

### 3.65 线性映射的作用类似于矩阵乘

设 $T \in \mathcal{L}(V, W), v \in V$. 设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基, $w_{1}, \ldots, w_{m}$ 是 $W$ 的基. 则

$$
\mathcal{M}(T v)=\mathcal{M}(T) \mathcal{M}(v)
$$

证明 设 $v=c_{1} v_{1}+\cdots+c_{n} v_{n}$, 其中 $c_{1}, \ldots, c_{n} \in \mathbf{F}$. 则
3.66

$$
T v=c_{1} T v_{1}+\cdots+c_{n} T v_{n}
$$

因此

$$
\begin{aligned}
\mathcal{M}(T v) & =c_{1} \mathcal{M}\left(T v_{1}\right)+\cdots+c_{n} \mathcal{M}\left(T v_{n}\right) \\
& =c_{1} \mathcal{M}(T)_{\cdot, 1}+\cdots+c_{n} \mathcal{M}(T)_{\cdot, n} \\
& =\mathcal{M}(T) \mathcal{M}(v)
\end{aligned}
$$

这里第一个等号由 3.66 以及 $\mathcal{M}$ 的线性得出，第二个等号由 3.64 得出，最后一个等号由 3.52 得出。

每个 $m \times n$ 矩阵 $A$ 诱导一个从 $\mathbf{F}^{n, 1}$ 到 $\mathbf{F}^{m, 1}$ 的线性映射, 即将 $x \in \mathbf{F}^{n, 1}$ 变为 $A x \in \mathbf{F}^{m, 1}$ 的矩阵乘。由上述命题，通过同构 $\mathcal{M}$ ，我们可以把（从有限维向量空间到有限维向量空间的）线性映射当作矩阵乘映射。具体来说，若 $T \in \mathcal{L}(V, W)$ ，并将 $v \in V$ 等同于 $\mathcal{M}(v) \in \mathbf{F}^{n, 1}$ ，则上述命题说，我们可以将 $T v$ 等同于 $\mathcal{M}(T) \mathcal{M}(v)$ 。

因为上一个结果允许我们（通过同构）将一个线性映射视为 $\mathbf{F}^{n, 1}$ 上某个矩阵 $A$的矩阵乘，所以要牢记这个矩阵 $A$ 不仅依赖于线性映射也依赖于基的选取。后续章节中很多最重要结果的主旨之一就是如何选取基以使矩阵 $A$ 尽可能简单。

本书关注的是线性映射而不是矩阵。不过，有时将线性映射想象为矩阵（或者将矩阵想象为线性映射）会提供重要的直觉，我们将会发现这种直觉非常有用。

## 算子

向量空间到其自身的线性映射非常重要，所以它们拥有特别的名字和记号.

### 3.67 定义 算子（operator）， $\mathcal{L}(V)$

- 向量空间到其自身的线性映射称为算子.
- 记号 $\mathcal{L}(V)$ 表示 $V$ 上全体算子所组成的集合. 即 $\mathcal{L}(V)=\mathcal{L}(V, V)$.
![](https://cdn.mathpix.com/cropped/2024_12_20_b7e31d481f69dee18878g-080.jpg?height=184&width=550&top_left_y=938&top_left_x=133)

若一个线性映射既单又满则可逆。对于一个算子，我们想知道，仅由单性或满性之一是否可以推出可逆性？对于无限维向量空间，这两个条件中的任何一个都不能单独推出可逆性。例如下面的例子，其中使用了例 3.4 中的两个算子。

### 3.68 例 单或满都不蕴涵可逆

- $\mathcal{P}(\mathbf{R})$ 上乘以 $x^{2}$ 的映射是单的，但不是满的。
- $\mathrm{F}^{\infty}$ 上的向后移位算子是满的, 但不是单的.

从上面的例子来看, 下面的命题很不寻常. 它说的是, 对于有限维向量空间上的算子，单性和满性中的每一个都能推出另一个。通常检验有限维向量空间上的算子是单的要更容易，而由单性可自然得到满性。

### 3.69 在有限维的情形，单性等价于满性

设 $V$ 是有限维的，并设 $T \in \mathcal{L}(V)$ ，则以下陈述等价：
(a) $T$ 是可逆的；
(b) $T$ 是单的;
(c) $T$ 是满的.

证明（a）显然蕴涵（b）。
现在假设（b）成立， $T$ 是单的，从而 $\operatorname{null} T=\{0\}$ （由于 3.16）。由线性映射基本定理3.22,

$$
\operatorname{dim} \operatorname{range} T=\operatorname{dim} V-\operatorname{dim} \operatorname{null} T=\operatorname{dim} V \text {. }
$$

于是 range $T=V$ 。从而 $T$ 是满的. 因此 (b) 蕴涵 (c).
现在假设 (c) 成立, $T$ 是满的, 从而 range $T=V$ 。由线性映射基本定理 3.22,

$$
\operatorname{dim} \operatorname{null} T=\operatorname{dim} V-\operatorname{dim} \operatorname{range} T=0
$$

于是 null $T=\{0\}$. 故 $T$ 是单的（由于 3.16 ），从而 $T$ 是可逆的（已知 $T$ 是满的）. 因此（c）蕴涵（a）。

下面的例子展示了上述命题的用处. 虽然下面例子的结果也可以不用线性代数证明，但是用线性代数来证明更为简洁容易。
3.70 例 证明对每个多项式 $q \in \mathcal{P}(\mathbf{R})$ 都存在一个多项式 $p \in \mathcal{P}(\mathbf{R})$ 使得

$$
\left(\left(x^{2}+5 x+7\right) p\right)^{\prime \prime}=q
$$

证明 例 3.68 表明 3.69 之妙法不能用于无限维向量空间 $\mathcal{P}(\mathbf{R})$ 。然而每个非零多项式 $q$ 都有次数 $m$. 仅考虑 $\mathcal{P}_{m}(\mathbf{R})$ ，我们就可以在有限维向量空间上做了。

设 $q \in \mathcal{P}_{m}(\mathbf{R})$ 。定义 $T: \mathcal{P}_{m}(\mathbf{R}) \rightarrow \mathcal{P}_{m}(\mathbf{R})$ 为 $T p=\left(\left(x^{2}+5 x+7\right) p\right)^{\prime \prime}$ 。
用 $\left(x^{2}+5 x+7\right)$ 去乘一个非零多项式，将使这个多项式的次数增加 2 ，然后做两次微分次数又降低 2 ，所以 $T$ 的确是 $\mathcal{P}_{m}(\mathbf{R})$ 上的算子。

二阶导数为 0 的多项式形如 $a x+b$, 其中 $a, b \in \mathbf{R}$. 于是 null $T=\{0\}$. 因此 $T$是单的。

现在 3.69 表明 $T$ 是满的. 因此有多项式 $p \in \mathcal{P}_{m}(\mathbf{R})$ 使得 $\left(\left(x^{2}+5 x+7\right) p\right)^{\prime \prime}=q$.
6.A 节的习题 30 给出了 3.69 的一个类似但更炫的应用. 这个习题中的结果不使用线性代数很难证明。

## 习题 3.D

1 设 $T \in \mathcal{L}(U, V)$ 和 $S \in \mathcal{L}(V, W)$ 都是可逆的线性映射。证明 $S T \in \mathcal{L}(U, W)$ 可逆且 $(S T)^{-1}=T^{-1} S^{-1}$ 。
2 设 $V$ 是有限维的且 $\operatorname{dim} V>1$. 证明 $V$ 上不可逆的算子构成的集合不是 $\mathcal{L}(V)$ 的子空间。
3 设 $V$ 是有限维的， $U$ 是 $V$ 的子空间，且 $S \in \mathcal{L}(U, V)$ 。证明：存在可逆的算子 $T \in \mathcal{L}(V)$ 使得对每个 $u \in U$ 均有 $T u=S u$ 当且仅当 $S$ 是单射.
4 设 $W$ 是有限维的， $T_{1}, T_{2} \in \mathcal{L}(V, W)$ 。证明： null $T_{1}=\operatorname{null} T_{2}$ 当且仅当存在可逆的算子 $S \in \mathcal{L}(W)$ 使得 $T_{1}=S T_{2}$ 。
5 设 $V$ 是有限维的， $T_{1}, T_{2} \in \mathcal{L}(V, W)$ 。证明：range $T_{1}=\operatorname{range} T_{2}$ 当且仅当存在可逆的算子 $S \in \mathcal{L}(V)$ 使得 $T_{1}=T_{2} S$ 。

6 设 $V$ 和 $W$ 是有限维的， $T_{1}, T_{2} \in \mathcal{L}(V, W)$ 。证明：存在可逆的算子 $R \in \mathcal{L}(V)$ 和 $S \in \mathcal{L}(W)$ 使得 $T_{1}=S T_{2} R$ 当且仅当 $\operatorname{dim} \operatorname{null} T_{1}=\operatorname{dim} \operatorname{null} T_{2}$ 。
7 设 $V$ 和 $W$ 是有限维的， $v \in V, E=\{T \in \mathcal{L}(V, W): T v=0\}$.
(a) 证明 $E$ 是 $\mathcal{L}(V, W)$ 的子空间.
(b) 假设 $v \neq 0$ ，则 $\operatorname{dim} E$ 等于多少？

8 设 $V$ 是有限维的， $T: V \rightarrow W$ 是 $V$ 到 $W$ 的满的线性映射。证明存在 $V$ 的子空间 $U$ 使得 $\left.T\right|_{U}$ 是 $U$ 到 $W$ 的同构。（这里 $\left.T\right|_{U}$ 表示函数 $T$ 限制在 $U$ 上. 也就是说， $\left.T\right|_{U}$ 是一个函数，其定义域为 $U$ ，且对任意 $u \in U$ 有 $\left.T\right|_{U}(u)=T u$ 。）
9 设 $V$ 是有限维的， $S, T \in \mathcal{L}(V)$ 。证明 $S T$ 可逆当且仅当 $S$ 和 $T$ 都可逆。
10 设 $V$ 是有限维的， $S, T \in \mathcal{L}(V)$ 。证明 $S T=I$ 当且仅当 $T S=I$.
11 设 $V$ 是有限维的, $S, T, U \in \mathcal{L}(V)$ 且 $S T U=I$. 证明 $T$ 可逆且 $T^{-1}=U S$.
12 说明上题的结果在 $V$ 不是有限维时未必成立。
13 设 $V$ 是有限维的，并设 $R, S, T \in \mathcal{L}(V)$ 使得 $R S T$ 是满射. 证明 $S$ 是单射.
14 设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基。映射 $T: V \rightarrow \mathbf{F}^{n, 1}$ 定义为 $T v=\mathcal{M}(v)$ ，这里 $\mathcal{M}(v)$ 是 $v \in V$ 关于基 $v_{1}, \ldots, v_{n}$ 的矩阵。证明 $T$ 是 $V$ 到 $\mathbf{F}^{n, 1}$ 的同构。
15 证明 $\mathbf{F}^{n, 1}$ 到 $\mathbf{F}^{m, 1}$ 的每个线性映射都是矩阵乘。 也就是说，若 $T \in \mathcal{L}\left(\mathbf{F}^{n, 1}, \mathbf{F}^{m, 1}\right)$ ，则存在 $m \times n$ 矩阵 $A$ 使得对每个 $x \in \mathbf{F}^{n, 1}$ 都有 $T x=A x$.
16 设 $V$ 是有限维的， $T \in \mathcal{L}(V)$ 。证明： $T$ 是标量乘以恒等映射当且仅当对每个 $S \in \mathcal{L}(V)$ 均有 $S T=T S$ 。
17 设 $V$ 是有限维的，且 $\mathcal{E}$ 是 $\mathcal{L}(V)$ 的子空间使得对所有 $S \in \mathcal{L}(V)$ 和所有 $T \in \mathcal{E}$ 均有 $S T \in \mathcal{E}$ 和 $T S \in \mathcal{E}$ 。证明 $\mathcal{E}=\{0\}$ 或 $\mathcal{E}=\mathcal{L}(V)$.
18 证明 $V$ 和 $\mathcal{L}(\mathbf{F}, V)$ 是同构的向量空间。
19 设 $T \in \mathcal{L}(\mathcal{P}(\mathbf{R}))$ 是单的，且对每个非零多项式 $p \in \mathcal{P}(\mathbf{R})$ 均有 $\operatorname{deg} T p \leq \operatorname{deg} p$.
(a) 证明 $T$ 是满的.
(b) 证明对每个非零的 $p \in \mathcal{P}(\mathbf{R})$ 均有 $\operatorname{deg} T p=\operatorname{deg} p$.

20 设 $n$ 是正整数， $A_{i, j} \in \mathbf{F}, i, j=1, \ldots, n$ 。证明下面两个陈述等价（注意：以下方程组中方程的数目都等于变量的数目):
(a) 平凡解 $x_{1}=\cdots=x_{n}=0$ 是下面的齐次方程组的唯一解:

$$
\left\{\begin{array}{c}
\sum_{k=1}^{n} A_{1, k} x_{k}=0 \\
\vdots \\
\sum_{k=1}^{n} A_{n, k} x_{k}=0
\end{array}\right.
$$

(b) 对每组 $c_{1}, \ldots, c_{n} \in \mathbf{F}$ 下面的方程组都有解:

$$
\left\{\begin{array}{c}
\sum_{k=1}^{n} A_{1, k} x_{k}=c_{1} \\
\vdots \\
\sum_{k=1}^{n} A_{n, k} x_{k}=c_{n}
\end{array}\right.
$$

## 3.E 向量空间的积与商

## 向量空间的积

通常在处理多个向量空间时，这些向量空间都应当在同一个域上.

### 3.71 定义 向量空间的积（product of vector spaces）

设 $V_{1}, \ldots, V_{m}$ 均为 $\mathbf{F}$ 上的向量空间。

- 规定积 $V_{1} \times \cdots \times V_{m}$ 为

$$
V_{1} \times \cdots \times V_{m}=\left\{\left(v_{1}, \ldots, v_{m}\right): v_{1} \in V_{1}, \ldots, v_{m} \in V_{m}\right\}
$$

- 规定 $V_{1} \times \cdots \times V_{m}$ 上的加法为

$$
\left(u_{1}, \ldots, u_{m}\right)+\left(v_{1}, \ldots, v_{m}\right)=\left(u_{1}+v_{1}, \ldots, u_{m}+v_{m}\right)
$$

- 规定 $V_{1} \times \cdots \times V_{m}$ 上的标量乘法为

$$
\lambda\left(v_{1}, \ldots, v_{m}\right)=\left(\lambda v_{1}, \ldots, \lambda v_{m}\right)
$$

3.72 例 $\mathcal{P}_{2}(\mathbf{R}) \times \mathbf{R}^{3}$ 中的元素是长度为 2 的组, 组的第一项是 $\mathcal{P}_{2}(\mathbf{R})$ 中的元素, 第二项是 $\mathbf{R}^{3}$ 中的元素。例如 $\left(5-6 x+4 x^{2},(3,8,7)\right) \in \mathcal{P}_{2}(\mathbf{R}) \times \mathbf{R}^{3}$.

以下命题表明向量空间的积按上面定义的加法和标量乘法构成向量空间.

### 3.73 向量空间的积是向量空间

设 $V_{1}, \ldots, V_{m}$ 均为 $\mathbf{F}$ 上的向量空间，则 $V_{1} \times \cdots \times V_{m}$ 是 $\mathbf{F}$ 上的向量空间.
上述结果的证明留给读者. 注意 $V_{1} \times \cdots \times V_{m}$ 的加法单位元是 $(0, \ldots, 0)$, 这里第 $j$ 个位置的 0 是 $V_{j}$ 的加法单位元. $\left(v_{1}, \ldots, v_{m}\right) \in V_{1} \times \cdots \times V_{m}$ 的加法逆元是 $\left(-v_{1}, \ldots,-v_{m}\right)$ 。
3.74 例 $\mathbf{R}^{2} \times \mathbf{R}^{3}$ 等于 $\mathbf{R}^{5}$ 吗？ $\mathbf{R}^{2} \times \mathbf{R}^{3}$ 同构于 $\mathbf{R}^{5}$ 吗？

解 $\mathbf{R}^{2} \times \mathbf{R}^{3}$ 的元素是组 $\left(\left(x_{1}, x_{2}\right),\left(x_{3}, x_{4}, x_{5}\right)\right)$ ，其中 $x_{1}, x_{2}, x_{3}, x_{4}, x_{5} \in \mathbf{R}$ 。
$\mathbf{R}^{5}$ 的元素是组 $\left(x_{1}, x_{2}, x_{3}, x_{4}, x_{5}\right)$ ，其中 $x_{1}, x_{2}, x_{3}, x_{4}, x_{5} \in \mathbf{R}$.

虽然它们看起来几乎一样，但并不是同一种对象。 $\mathbf{R}^{2} \times \mathbf{R}^{3}$ 的元素是长度为 2 的组（该组的第一项是长度为 2 的组，第二项是长度为 3 的组）， $\mathbf{R}^{5}$ 的元素是长度为 5的组. 所以 $\mathbf{R}^{2} \times \mathbf{R}^{3}$ 不等于 $\mathbf{R}^{5}$ 。

将向量 $\left(\left(x_{1}, x_{2}\right),\left(x_{3}, x_{4}, x_{5}\right)\right) \in \mathbf{R}^{2} \times \mathbf{R}^{3}$ 变为 $\left(x_{1}, x_{2}, x_{3}, x_{4}, x_{5}\right) \in \mathbf{R}^{5}$ 的线性映射显然是 $\mathbf{R}^{2} \times \mathbf{R}^{3}$ 到 $\mathbf{R}^{5}$ 的同构。所以这两个向量空间是同构的。

这个同构非常自然，只是把元素换了种写法。有些人甚至通俗地说 $\mathbf{R}^{2} \times \mathbf{R}^{3}$ 等于 $\mathbf{R}^{5}$ ，这种说法严格来说是不正确的，但却抓住了通过改变写法就可使二者等同这一本质。

下面的例子说明了 3.76 的证明思想.
3.75 例 求 $\mathcal{P}_{2}(\mathbf{R}) \times \mathbf{R}^{2}$ 的一个基。

解 考虑 $\mathcal{P}_{2}(\mathbf{R}) \times \mathbf{R}^{2}$ 中元素构成的长度为 5 的组:

$$
(1,(0,0)),(x,(0,0)),\left(x^{2},(0,0)\right),(0,(1,0)),(0,(0,1))
$$

上述组是线性无关的且张成 $\mathcal{P}_{2}(\mathbf{R}) \times \mathbf{R}^{2}$ ，因此是 $\mathcal{P}_{2}(\mathbf{R}) \times \mathbf{R}^{2}$ 的基。

### 3.76 积的维数等于维数的和

设 $V_{1}, \ldots, V_{m}$ 均为有限维向量空间. 则 $V_{1} \times \cdots \times V_{m}$ 是有限维的, 且

$$
\operatorname{dim}\left(V_{1} \times \cdots \times V_{m}\right)=\operatorname{dim} V_{1}+\cdots+\operatorname{dim} V_{m}
$$

证明 选取每个 $V_{j}$ 的一个基。对于每个 $V_{j}$ 的每个基向量，考虑 $V_{1} \times \cdots \times V_{m}$ 的如下元素：第 $j$ 个位置为此基向量，其余位置为 0 。所有这些向量构成的组是线性无关的，且张成 $V_{1} \times \cdots \times V_{m}$ ，因此是 $V_{1} \times \cdots \times V_{m}$ 的基。这个基的长度是 $\operatorname{dim} V_{1}+\cdots+\operatorname{dim} V_{m}$.

## 积与直和

在以下命题中, 由 $U_{1}+\cdots+U_{m}$ 的定义, 映射 $\Gamma$ 是满的. 所以这个命题中的最后一个词 "单射"可以改为"满射"。

### 3.77 积与直和

设 $U_{1}, \ldots, U_{m}$ 均为 $V$ 的子空间。线性映射 $\Gamma: U_{1} \times \cdots \times U_{m} \rightarrow U_{1}+\cdots+U_{m}$定义为 $\Gamma\left(u_{1}, \ldots, u_{m}\right)=u_{1}+\cdots+u_{m}$ 。则 $U_{1}+\cdots+U_{m}$ 是直和当且仅当 $\Gamma$ 是单射。

证明 线性映射 $\Gamma$ 是单的当且仅当将 0 表示为 $U_{j}$ 的元素之和 $u_{1}+\cdots+u_{m}$ 时只能取每个 $u_{j}$ 等于 0 . 于是 1.44 表明 $\Gamma$ 是单的当且仅当 $U_{1}+\cdots+U_{m}$ 是直和.

### 3.78 和为直和当且仅当维数相加

设 $V$ 是有限维的, 且 $U_{1}, \ldots, U_{m}$ 均为 $V$ 的子空间. 则 $U_{1}+\cdots+U_{m}$ 是直和当且仅当 $\operatorname{dim}\left(U_{1}+\cdots+U_{m}\right)=\operatorname{dim} U_{1}+\cdots+\operatorname{dim} U_{m}$.

证明 3.77 中的映射 $\Gamma$ 是满的. 所以由线性映射基本定理 3.22, $\Gamma$ 是单的当且仅当

$$
\operatorname{dim}\left(U_{1}+\cdots+U_{m}\right)=\operatorname{dim}\left(U_{1} \times \cdots \times U_{m}\right)
$$

利用 3.77 和 3.76 可知, $U_{1}+\cdots+U_{m}$ 是直和当且仅当

$$
\operatorname{dim}\left(U_{1}+\cdots+U_{m}\right)=\operatorname{dim} U_{1}+\cdots+\operatorname{dim} U_{m}
$$

当 $m=2$ 时, $U_{1}+U_{2}$ 是直和当且仅当 $\operatorname{dim}\left(U_{1}+U_{2}\right)=\operatorname{dim} U_{1}+\operatorname{dim} U_{2}$. 利用 1.45 和 2.43 可以给出这一结果的另一个证明.

## 向量空间的商

我们先定义向量与子空间的和，以便引入商空间.
3.79 定义 $v+U$

设 $v \in V, U$ 是 $V$ 的子空间. 则 $v+U$ 是 $V$ 的子集, 定义如下:

$$
v+U=\{v+u: u \in U\}
$$

3.80 例 设

$$
U=\left\{(x, 2 x) \in \mathbf{R}^{2}: x \in \mathbf{R}\right\}
$$

则 $U$ 是 $\mathbf{R}^{2}$ 中过原点的斜率为 2 的直线.于是

$$
(17,20)+U
$$

是 $\mathbf{R}^{2}$ 中包含点 $(17,20)$ 的斜率为 2 的直线.
![](https://cdn.mathpix.com/cropped/2024_12_20_b7e31d481f69dee18878g-085.jpg?height=397&width=421&top_left_y=1415&top_left_x=828)
3.81 定义 仿射子集（affine subset）、平行（parallel）

- $V$ 的仿射子集是 $V$ 的形如 $v+U$ 的子集，其中 $v \in V, U$ 是 $V$ 的子空间.
- 对于 $v \in V$ 和 $V$ 的子空间 $U$, 称仿射子集 $v+U$ 平行于 $U$.


### 3.82 例 平行的仿射子集

- 在上面的例 3.80 中, $\mathbf{R}^{2}$ 中所有斜率为 2 的直线均平行于 $U$.
- 若 $U=\left\{(x, y, 0) \in \mathbf{R}^{3}: x, y \in \mathbf{R}\right\}$, 则 $\mathbf{R}^{3}$ 的平行于 $U$ 的仿射子集是 $\mathbf{R}^{3}$ 中在通常意义下平行于 $x y$ 平面 $U$ 的那些平面.
重要：按照 3.81 所给出的平行的定义， $\mathbf{R}^{3}$ 中的直线都不是平行于平面 $U$ 的仿射子集。


### 3.83 定义 商空间（quotient space）， $V / U$

设 $U$ 是 $V$ 的子空间。则商空间 $V / U$ 是指 $V$ 的所有平行于 $U$ 的仿射子集的集合. 也就是说，

$$
V / U=\{v+U: v \in V\}
$$

### 3.84 例 商空间

- 若 $U=\left\{(x, 2 x) \in \mathbf{R}^{2}: x \in \mathbf{R}\right\}$, 则 $\mathbf{R}^{2} / U$ 是 $\mathbf{R}^{2}$ 中所有斜率为 2 的直线的集合.
- 若 $U$ 是 $\mathbf{R}^{3}$ 中包含原点的直线，则 $\mathbf{R}^{3} / U$ 是 $\mathbf{R}^{3}$ 中所有平行于 $U$ 的直线的集合.
- 若 $U$ 是 $\mathbf{R}^{3}$ 中包含原点的平面，则 $\mathbf{R}^{3} / U$ 是 $\mathbf{R}^{3}$ 中所有平行于 $U$ 的平面的集合.

接下来的目标是使 $V / U$ 成为向量空间. 为此我们需要下面的命题.

### 3.85 平行于 $U$ 的两个仿射子集或相等或不相交

设 $U$ 是 $V$ 的子空间, $v, w \in V$. 则以下陈述等价:
(a) $v-w \in U$;
(b) $v+U=w+U$;
(c) $(v+U) \cap(w+U) \neq \varnothing$.

证明 首先假设 (a) 成立, $v-w \in U$. 若 $u \in U$, 则

$$
v+u=w+((v-w)+u) \in w+U
$$

于是 $v+U \subset w+U$. 类似地, $w+U \subset v+U$. 因此 $v+U=w+U$, 这就证明了 (a)蕴涵 (b).
(b) 显然蕴涵 (c).

现在假设 (c) 成立, $(v+U) \cap(w+U) \neq \varnothing$. 于是存在 $u_{1}, u_{2} \in U$ 使得

$$
v+u_{1}=w+u_{2}
$$

则 $v-w=u_{2}-u_{1}$. 因此 $v-w \in U$, 这就证明了 (c) 蕴涵 (a), 从而完成证明.
现在我们可以在 $V / U$ 上定义加法和标量乘法了.
3.86 定义 $V / U$ 上的加法和标量乘法（addition and scalar multiplication on $V / U$ ）

设 $U$ 是 $V$ 的子空间. 则 $V / U$ 上的加法和标量乘法定义为：对任意 $v, w \in V$ 和 $\lambda \in \mathbf{F}$,

$$
\begin{aligned}
(v+U)+(w+U) & =(v+w)+U \\
\lambda(v+U) & =(\lambda v)+U
\end{aligned}
$$

作为以下命题证明的一部分，我们将证明上述定义是有意义的。

### 3.87 商空间是向量空间

设 $U$ 是 $V$ 的子空间. 则 $V / U$ 按照上面定义的加法和标量乘法构成向量空间.
证明 在上面定义的 $V / U$ 上的加法和标量乘法中，一个潜在的问题是平行于 $U$的仿射子集的表示并不是唯一的。具体来说，设 $v, w \in V$ ，假设 $\hat{v}, \hat{w} \in V$ 使得 $v+U=\hat{v}+U$ 和 $w+U=\hat{w}+U$ 。要证明上面给出的 $V / U$ 上的加法是有意义的，必须证明 $(v+w)+U=(\hat{v}+\hat{w})+U$.

由 3.85 有

$$
v-\hat{v} \in U, \quad w-\hat{w} \in U
$$

因为 $U$ 是 $V$ 的子空间, 所以在加法下封闭, 这说明 $(v-\hat{v})+(w-\hat{w}) \in U$. 于是 $(v+w)-(\hat{v}+\hat{w}) \in U$ 。再使用 3.85 可得

$$
(v+w)+U=(\hat{v}+\hat{w})+U .
$$

因此 $V / U$ 上的加法定义是合理的。
类似地，设 $\lambda \in \mathbf{F}$ 。因为 $U$ 是 $V$ 的子空间，所以在标量乘法下封闭，从而有 $\lambda(v-\hat{v}) \in U$ 。于是 $\lambda v-\lambda \hat{v} \in U$ 。因此 3.85 表明 $(\lambda v)+U=(\lambda \hat{v})+U$ 。所以 $V / U$ 上的标量乘法的定义是有意义的。

既然我们已经在 $V / U$ 上定义了加法和标量乘法，验证这些运算使得 $V / U$ 成为向量空间就是简单的事了，留给读者。注意 $V / U$ 上的加法单位元是 $0+U$ （等于 $U$ ）, $v+U$ 的加法逆元是 $(-v)+U$ 。

下面的概念将给出计算 $V / U$ 的维数的简单方法.

### 3.88 定义 商映射（quotient map）， $\pi$

设 $U$ 是 $V$ 的子空间。商映射 $\pi$ 是如下定义的线性映射 $\pi: V \rightarrow V / U$ ：对任意 $v \in V$,

$$
\pi(v)=v+U
$$

读者应当验证 $\pi$ 的确是线性映射. 虽然 $\pi$ 同时依赖于 $U$ 和 $V$ ，但它们并未出现在记号中, 这是因为它们在上下文中是自明的.

### 3.89 商空间的维数

设 $V$ 是有限维的， $U$ 是 $V$ 的子空间。则

$$
\operatorname{dim} V / U=\operatorname{dim} V-\operatorname{dim} U
$$

证明 设 $\pi$ 是 $V$ 到 $V / U$ 的商映射。由 3.85 我们有 null $\pi=U$ 。显然 range $\pi=V / U$.于是线性映射基本定理 3.22 表明

$$
\operatorname{dim} V=\operatorname{dim} U+\operatorname{dim} V / U
$$

由此可得要证明的结果.
$V$ 上的每个线性映射 $T$ 都诱导 $V /(\operatorname{null} T)$ 上的一个线性映射 $\tilde{T}$ ，现在就来定义它.

### 3.90 定义 $\tilde{T}$

设 $T \in \mathcal{L}(V, W)$. 定义 $\tilde{T}: V /(\operatorname{null} T) \rightarrow W$ 如下:

$$
\tilde{T}(v+\operatorname{null} T)=T v
$$

为了证明 $\tilde{T}$ 的定义是有意义的，设 $u, v \in V$ 使得 $u+\operatorname{null} T=v+\operatorname{null} T$ 。由3.85有 $u-v \in \operatorname{null} T$ 。于是 $T(u-v)=0$. 所以 $T u=T v$ 。因此 $\tilde{T}$ 的定义是有意义的.

## $3.91 \tilde{T}$ 的零空间与值域

设 $T \in \mathcal{L}(V, W)$. 则
(a) $\tilde{T}$ 是 $V /(\operatorname{null} T)$ 到 $W$ 的线性映射;
(b) $\tilde{T}$ 是单的;
(c) range $\tilde{T}=\operatorname{range} T$;
(d) $V /(\operatorname{null} T)$ 同构于 range $T$.

## 证明

(a) 验证 $\tilde{T}$ 是线性的留给读者.
（b）设 $v \in V, \tilde{T}(v+\operatorname{null} T)=0$. 则 $T v=0$ 。于是 $v \in \operatorname{null} T$. 所以 3.85 说明 $v+\operatorname{null} T=0+\operatorname{null} T$ 。这表明 $\operatorname{null} \tilde{T}=\{0\}$, 因此 $\tilde{T}$ 是单的.
(c) $\tilde{T}$ 的定义表明 range $\tilde{T}=\operatorname{range} T$ 。
(d) (b) 和 (c) 表明, 若将 $\tilde{T}$ 视为到 range $T$ 的映射, 则 $\tilde{T}$ 是 $V / \operatorname{null} T$ ) 到 $\operatorname{range} T$ 的同构.

## 习题 3.E

1 设 $T$ 是 $V$ 到 $W$ 的函数. 定义 $T$ 的图为 $V \times W$ 的如下子集:

$$
T \text { 的图 }=\{(v, T v) \in V \times W: v \in V\} \text {. }
$$

证明 $T$ 是线性映射当且仅当 $T$ 的图是 $V \times W$ 的子空间.
正式地讲， $V$ 到 $W$ 的函数 $T$ 是 $V \times W$ 的一个子集 $T$ ，使得对每个 $v \in V$ 都恰有一个元素 $(v, w) \in T$ 。 也就是说，函数正式地讲就是上面所谓的图。我们通常并不把函数看成上面的这种正式形式。然而，如果采用上面的正式形式，则本题可以重述为：证明 $V$ 到 $W$ 的函数 $T$ 是线性映射当且仅当 $T$ 是 $V \times W$ 的子空间。
2 设 $V_{1}, \ldots, V_{m}$ 均为向量空间使得 $V_{1} \times \cdots \times V_{m}$ 是有限维的。证明对每个 $j=$ $1, \ldots, m$ 来说 $V_{j}$ 都是有限维的。
3 给出一个向量空间 $V$ 与它的两个子空间 $U_{1}$ 和 $U_{2}$ 的例子, 使得 $U_{1} \times U_{2}$ 同构于 $U_{1}+U_{2}$, 但 $U_{1}+U_{2}$ 不是直和。
提示：向量空间 $V$ 一定是无限维的。
4 设 $V_{1}, \ldots, V_{m}$ 均为向量空间。证明 $\mathcal{L}\left(V_{1} \times \cdots \times V_{m}, W\right)$ 和 $\mathcal{L}\left(V_{1}, W\right) \times \cdots \times \mathcal{L}\left(V_{m}, W\right)$是同构的向量空间。

5 设 $W_{1}, \ldots, W_{m}$ 均为向量空间。证明 $\mathcal{L}\left(V, W_{1} \times \cdots \times W_{m}\right)$ 和 $\mathcal{L}\left(V, W_{1}\right) \times \cdots \times$ $\mathcal{L}\left(V, W_{m}\right)$ 是同构的向量空间。
6 对于正整数 $n$, 定义 $V^{n}$ 如下:

$$
V^{n}=\underbrace{V \times \cdots \times V}_{n \uparrow V} .
$$

证明 $V^{n}$ 和 $\mathcal{L}\left(\mathbf{F}^{n}, V\right)$ 是同构的向量空间。
7 设 $v$ 和 $x$ 均为 $V$ 中的向量， $U$ 和 $W$ 均为 $V$ 的子空间， $v+U=x+W$ 。证明 $U=W$.

8 证明： $V$ 的非空子集 $A$ 是 $V$ 的仿射子集当且仅当对于所有的 $v, w \in A$ 和 $\lambda \in \mathbf{F}$均有 $\lambda v+(1-\lambda) w \in A$ 。
9 设 $A_{1}$ 和 $A_{2}$ 均为 $V$ 的仿射子集。证明交 $A_{1} \cap A_{2}$ 是 $V$ 的仿射子集或者空集.
10 证明 $V$ 的任意一族仿射子集的交是 $V$ 的仿射子集或者空集。
11 设 $v_{1}, \ldots, v_{m} \in V$ 。令

$$
A=\left\{\lambda_{1} v_{1}+\cdots+\lambda_{m} v_{m}: \lambda_{1}, \ldots, \lambda_{m} \in \mathbf{F} \text { 且 } \lambda_{1}+\cdots+\lambda_{m}=1\right\} .
$$

(a) 证明 $A$ 是 $V$ 的仿射子集。
(b) 证明 $V$ 的每个包含 $v_{1}, \ldots, v_{m}$ 的仿射子集均包含 $A$.
(c) 证明有某个 $v \in V$ 及 $V$ 的某个子空间 $U$ 使得 $A=v+U$ 且 $\operatorname{dim} U \leq m-1$.

12 设 $U$ 是 $V$ 的子空间使得 $V / U$ 是有限维的. 证明 $V$ 同构于 $U \times(V / U)$.

13 设 $U$ 是 $V$ 的子空间， $v_{1}+U, \ldots, v_{m}+U$ 是 $V / U$ 的基， $u_{1}, \ldots, u_{n}$ 是 $U$ 的基. 证明 $v_{1}, \ldots, v_{m}, u_{1}, \ldots, u_{n}$ 是 $V$ 的基。
14 设 $U=\left\{\left(x_{1}, x_{2}, \ldots\right) \in \mathbf{F}^{\infty}\right.$ : 只有有限多个 $j$ 使得 $\left.x_{j} \neq 0\right\}$.
(a) 证明 $U$ 是 $\mathbf{F}^{\infty}$ 的子空间。
(b) 证明 $\mathbf{F}^{\infty} / U$ 是无限维的。

15 设 $\varphi \in \mathcal{L}(V, \mathbf{F}), \varphi \neq 0$. 证明 $\operatorname{dim} V /($ null $\varphi)=1$ 。
16 设 $U$ 是 $V$ 的子空间使得 $\operatorname{dim} V / U=1$ 。证明存在 $\varphi \in \mathcal{L}(V, \mathbf{F})$ 使得 null $\varphi=U$.
17 设 $U$ 是 $V$ 的子空间使得 $V / U$ 是有限维的。证明存在 $V$ 的子空间 $W$ 使得 $\operatorname{dim} W=\operatorname{dim} V / U$ 且 $V=U \oplus W$ 。
18 设 $T \in \mathcal{L}(V, W)$, 并设 $U$ 是 $V$ 的子空间. 用 $\pi$ 表示 $V$ 到 $V / U$ 的商映射. 证明:存在 $S \in \mathcal{L}(V / U, W)$ 使得 $T=S \circ \pi$ 当且仅当 $U \subset \operatorname{null} T$ 。
19 对有限集给出一个类比于 3.78 的恰当陈述，使得集合的并类比于子空间的和，不交并类比于直和。
20 设 $U$ 是 $V$ 的子空间. $\Gamma: \mathcal{L}(V / U, W) \rightarrow \mathcal{L}(V, W)$ 定义为 $\Gamma(S)=S \circ \pi$.
(a) 证明 $\Gamma$ 是线性映射.
(b) 证明 $\Gamma$ 是单的.
(c) 证明 range $\Gamma=\{T \in \mathcal{L}(V, W)$ : 对所有 $u \in U$ 有 $T u=0\}$.

## 3.F 对偶

## 对偶空间与对偶映射

映到标量域 $\mathbf{F}$ 的线性映射在线性代数中扮演了重要角色，因此它们有一个特别的名字：

### 3.92 定义 线性泛函（linear functional）

$V$ 上的线性泛函是从 $V$ 到 $\mathbf{F}$ 的线性映射. 也就是说, 线性泛函是 $\mathcal{L}(V, \mathbf{F})$ 中的元素。

### 3.93 例 线性泛函

- 定义 $\varphi: \mathbf{R}^{3} \rightarrow \mathbf{R}$ 为 $\varphi(x, y, z)=4 x-5 y+2 z$. 则 $\varphi$ 是 $\mathbf{R}^{3}$ 上的线性泛函.
- 取定 $\left(c_{1}, \ldots, c_{n}\right) \in \mathbf{F}^{n}$ 。定义 $\varphi: \mathbf{F}^{n} \rightarrow \mathbf{F}$ 为 $\varphi\left(x_{1}, \ldots, x_{n}\right)=c_{1} x_{1}+\cdots+c_{n} x_{n}$.则 $\varphi$ 是 $\mathrm{F}^{n}$ 上的线性泛函。
- 定义 $\varphi: \mathcal{P}(\mathbf{R}) \rightarrow \mathbf{R}$ 为 $\varphi(p)=3 p^{\prime \prime}(5)+7 p(4)$. 则 $\varphi$ 是 $\mathcal{P}(\mathbf{R})$ 上的线性泛函.
- 定义 $\varphi: \mathcal{P}(\mathbf{R}) \rightarrow \mathbf{R}$ 为 $\varphi(p)=\int_{0}^{1} p(x) \mathrm{d} x$. 则 $\varphi$ 是 $\mathcal{P}(\mathbf{R})$ 上的线性泛函.

向量空间 $\mathcal{L}(V, \mathbf{F})$ 也有一个特别的名字和一个特别的记号：
3.94 定义 对偶空间（dual space）， $V^{\prime}$
$V$ 上的所有线性泛函构成的向量空间称为 $V$ 的对偶空间，记为 $V^{\prime}$ 。也就是说， $V^{\prime}=\mathcal{L}(V, \mathbf{F})$ 。
$3.95 \operatorname{dim} V^{\prime}=\operatorname{dim} V$
设 $V$ 是有限维的. 则 $V^{\prime}$ 也是有限维的, 且 $\operatorname{dim} V^{\prime}=\operatorname{dim} V$.
证明 由 3.61 证得。
前面的 3.5 表明，在下面的定义中每个 $\varphi_{j}$ 都是合理定义的。

### 3.96 定义 对偶基（dual basis）

设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基，则 $v_{1}, \ldots, v_{n}$ 的对偶基 是 $V^{\prime}$ 中的元素组 $\varphi_{1}, \ldots, \varphi_{n}$ ，其中每个 $\varphi_{j}$ 都是 $V$ 上的线性泛函，使得

$$
\varphi_{j}\left(v_{k}\right)= \begin{cases}1, & \text { 当 } k=j, \\ 0, & \text { 当 } k \neq j .\end{cases}
$$

3.97 例 求 $\mathbf{F}^{n}$ 的标准基 $e_{1}, \ldots, e_{n}$ 的对偶基.

解 对于 $1 \leq j \leq n$, 定义 $\varphi_{j}$ 是 $\mathbf{F}^{n}$ 上的线性泛函, 它将 $\mathbf{F}^{n}$ 中的向量变为它的第 $j$个坐标. 也就是说，对于 $\left(x_{1}, \ldots, x_{n}\right) \in \mathbf{F}^{n}$ ，

$$
\varphi_{j}\left(x_{1}, \ldots, x_{n}\right)=x_{j}
$$

显然

$$
\varphi_{j}\left(e_{k}\right)= \begin{cases}1, & \text { 当 } k=j, \\ 0, & \text { 当 } k \neq j .\end{cases}
$$

于是 $\varphi_{1}, \ldots, \varphi_{n}$ 是 $\mathbf{F}^{n}$ 的标准基 $e_{1}, \ldots, e_{n}$ 的对偶基。

以下命题表明对偶基的确是基. 所以 "对偶基" 这个术语名正言顺.

### 3.98 对偶基是对偶空间的基

设 $V$ 是有限维的. 则 $V$ 的一个基的对偶基是 $V^{\prime}$ 的基.
证明 设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基. 用 $\varphi_{1}, \ldots, \varphi_{n}$ 表示其对偶基。
为了证明 $\varphi_{1}, \ldots, \varphi_{n}$ 是 $V^{\prime}$ 的一组线性无关的元素，设 $a_{1}, \ldots, a_{n} \in F$ 使得

$$
a_{1} \varphi_{1}+\cdots+a_{n} \varphi_{n}=0
$$

则对于 $j=1, \ldots, n$ 有 $\left(a_{1} \varphi_{1}+\cdots+a_{n} \varphi_{n}\right)\left(v_{j}\right)=a_{j}$ 。上面的等式表明 $a_{1}=\cdots=$ $a_{n}=0$ 。所以 $\varphi_{1}, \ldots, \varphi_{n}$ 是线性无关的。

现在 2.39 和 3.95 表明 $\varphi_{1}, \ldots, \varphi_{n}$ 是 $V^{\prime}$ 的基。
在下面的定义中, 若 $T$ 是 $V$ 到 $W$ 的线性映射, 则 $T^{\prime}$ 是 $W^{\prime}$ 到 $V^{\prime}$ 的线性映射.

### 3.99 定义 对偶映射（dual map）， $T^{\prime}$

若 $T \in \mathcal{L}(V, W)$ ，则 $T$ 的对偶映射是线性映射 $T^{\prime} \in \mathcal{L}\left(W^{\prime}, V^{\prime}\right)$ ：对于 $\varphi \in W^{\prime}$ ， $T^{\prime}(\varphi)=\varphi \circ T$ 。

若 $T \in \mathcal{L}(V, W)$ 且 $\varphi \in W^{\prime}$ ，则 $T^{\prime}(\varphi)$ 被定义为线性映射 $\varphi$ 与 $T$ 的复合。于是 $T^{\prime}(\varphi)$ 的确是 $V$ 到 $\mathbf{F}$ 的线性映射，也就是说， $T^{\prime}(\varphi) \in V^{\prime}$ 。

容易验证 $T^{\prime}$ 是 $W^{\prime}$ 到 $V^{\prime}$ 的线性映射：

- 若 $\varphi, \psi \in W^{\prime}$, 则 $T^{\prime}(\varphi+\psi)=(\varphi+\psi) \circ T=\varphi \circ T+\psi \circ T=T^{\prime}(\varphi)+T^{\prime}(\psi)$.
- 若 $\lambda \in \mathbf{F}, \varphi \in W^{\prime}$ ，则 $T^{\prime}(\lambda \varphi)=(\lambda \varphi) \circ T=\lambda(\varphi \circ T)=\lambda T^{\prime}(\varphi)$ 。

在下面的例子中，记号 ' 有两种毫不相关的意义： $D^{\prime}$ 表示线性映射 $D$ 的对偶映射，而 $p^{\prime}$ 表示多项式 $p$ 的导数。
3.100 例 定义 $D: \mathcal{P}(\mathbf{R}) \rightarrow \mathcal{P}(\mathbf{R})$ 为 $D p=p^{\prime}$.

- 设 $\varphi$ 是 $\mathcal{P}(\mathbf{R})$ 上由 $\varphi(p)=p(3)$ 定义的线性泛函. 则 $D^{\prime}(\varphi)$ 是 $\mathcal{P}(\mathbf{R})$ 上如下定义的线性泛函：

$$
\left(D^{\prime}(\varphi)\right)(p)=(\varphi \circ D)(p)=\varphi(D p)=\varphi\left(p^{\prime}\right)=p^{\prime}(3)
$$

也就是说， $D^{\prime}(\varphi)$ 是 $\mathcal{P}(\mathbf{R})$ 上将 $p$ 变为 $p^{\prime}(3)$ 的线性泛函。

- 设 $\varphi$ 是 $\mathcal{P}(\mathbf{R})$ 上由 $\varphi(p)=\int_{0}^{1} p(x) \mathrm{d} x$ 定义的线性泛函。则 $D^{\prime}(\varphi)$ 是 $\mathcal{P}(\mathbf{R})$ 上如下定义的线性泛函：

$$
\left(D^{\prime}(\varphi)\right)(p)=(\varphi \circ D)(p)=\varphi(D p)=\varphi\left(p^{\prime}\right)=\int_{0}^{1} p^{\prime}(x) \mathrm{d} x=p(1)-p(0) .
$$

也就是说， $D^{\prime}(\varphi)$ 是 $\mathcal{P}(\mathbf{R})$ 上将 $p$ 变为 $p(1)-p(0)$ 的线性泛函。

下面结果的前两条表明将 $T$ 变为 $T^{\prime}$ 的函数是 $\mathcal{L}(V, W)$ 到 $\mathcal{L}\left(W^{\prime}, V^{\prime}\right)$ 的线性映射。

在下面的第三条中, 注意 $S T$ 与 $T^{\prime} S^{\prime}$ 复合顺序是相反的（这里我们假定 $U$ 是 $\mathbf{F}$上的向量空间）。

### 3.101 对偶映射的代数性质

- 对所有 $S, T \in \mathcal{L}(V, W)$ 有 $(S+T)^{\prime}=S^{\prime}+T^{\prime}$.
- 对所有 $\lambda \in \mathbf{F}$ 和所有 $T \in \mathcal{L}(V, W)$ 有 $(\lambda T)^{\prime}=\lambda T^{\prime}$.
- 对所有 $T \in \mathcal{L}(U, V)$ 和所有 $S \in \mathcal{L}(V, W)$ 有 $(S T)^{\prime}=T^{\prime} S^{\prime}$.

证明 前两条的证明留给读者.
为了证明第三条, 设 $\varphi \in W^{\prime}$ 。则

$$
(S T)^{\prime}(\varphi)=\varphi \circ(S T)=(\varphi \circ S) \circ T=T^{\prime}(\varphi \circ S)=T^{\prime}\left(S^{\prime}(\varphi)\right)=\left(T^{\prime} S^{\prime}\right)(\varphi),
$$

其中第一个、第三个和第四个等号成立是由于对偶映射的定义，第二个等号成立是因为函数的复合是结合的, 最后一个等号是利用复合的定义.

对所有 $\varphi \in W^{\prime}$, 上述等式的第一项都等于

有些书用 $V^{*}$ 和 $T^{*}$ 来表示对偶空间 $V^{\prime}$ 和对偶映射 $T^{\prime}$ 。然而，我们将用 $T^{*}$ 表示伴随，在第 7 章学习内积空间的线性映射时将引入这一概念。

最后一项, 这表明 $(S T)^{\prime}=T^{\prime} S^{\prime}$.

## 线性映射的对偶的零空间和值域

本小节的目的是利用 range $T$ 和 null $T$ 来描述 null $T^{\prime}$ 和 range $T^{\prime}$. 为此我们需要下面的定义.
3.102 定义 零化子（annihilator）， $U^{0}$

对于 $U \subset V, U$ 的零化子（记为 $U^{0}$ ）定义如下：

$$
U^{0}=\left\{\varphi \in V^{\prime}: \text { 对所有 } u \in U \text { 都有 } \varphi(u)=0\right\} \text {. }
$$

3.103 例 设 $U$ 是 $\mathcal{P}(\mathbf{R})$ 的用 $x^{2}$ 乘以所有多项式所得到的子空间. 若 $\varphi$ 是 $\mathcal{P}(\mathbf{R})$ 上由 $\varphi(p)=p^{\prime}(0)$ 定义的线性泛函, 则 $\varphi \in U^{0}$.

对于 $U \subset V$ ，零化子 $U^{0}$ 是对偶空间 $V^{\prime}$ 的子集。于是 $U^{0}$ 依赖于包含 $U$ 的向量空间, 所以记号 $U_{V}^{0}$ 应该更准确. 然而包含 $U$ 的向量空间通常在上下文中是自明的,所以我们采用更简单的记号 $U^{0}$.
3.104 例 用 $e_{1}, e_{2}, e_{3}, e_{4}, e_{5}$ 表示 $\mathbf{R}^{5}$ 的标准基, 用 $\varphi_{1}, \varphi_{2}, \varphi_{3}, \varphi_{4}, \varphi_{5}$ 表示 $\left(\mathbf{R}^{5}\right)^{\prime}$ 的对偶基. 设

$$
U=\operatorname{span}\left(e_{1}, e_{2}\right)=\left\{\left(x_{1}, x_{2}, 0,0,0\right) \in \mathbf{R}^{5}: x_{1}, x_{2} \in \mathbf{R}\right\}
$$

证明 $U^{0}=\operatorname{span}\left(\varphi_{3}, \varphi_{4}, \varphi_{5}\right)$.
证明 回想一下 (见 3.97 ), $\varphi_{j}$ 是 $\mathbf{R}^{5}$ 上将向量变为它的第 $j$ 个坐标的线性泛函:

$$
\varphi_{j}\left(x_{1}, x_{2}, x_{3}, x_{4}, x_{5}\right)=x_{j}
$$

设 $\varphi \in \operatorname{span}\left(\varphi_{3}, \varphi_{4}, \varphi_{5}\right)$. 则有 $c_{3}, c_{4}, c_{5} \in \mathbf{R}$ 使得 $\varphi=c_{3} \varphi_{3}+c_{4} \varphi_{4}+c_{5} \varphi_{5}$. 若 $\left(x_{1}, x_{2}, 0,0,0\right) \in U$, 则

$$
\varphi\left(x_{1}, x_{2}, 0,0,0\right)=\left(c_{3} \varphi_{3}+c_{4} \varphi_{4}+c_{5} \varphi_{5}\right)\left(x_{1}, x_{2}, 0,0,0\right)=0
$$

于是 $\varphi \in U^{0}$. 也就是说我们已证明了 $\operatorname{span}\left(\varphi_{3}, \varphi_{4}, \varphi_{5}\right) \subset U^{0}$.
为了证明另一个方向的包含，设 $\varphi \in U^{0}$ 。由于对偶基是 $\left(\mathbf{R}^{5}\right)^{\prime}$ 的基，存在 $c_{1}, c_{2}, c_{3}, c_{4}, c_{5} \in \mathbf{R}$ 使得 $\varphi=c_{1} \varphi_{1}+c_{2} \varphi_{2}+c_{3} \varphi_{3}+c_{4} \varphi_{4}+c_{5} \varphi_{5}$ 。由 $e_{1} \in U$ 和 $\varphi \in U^{0}$可得

$$
0=\varphi\left(e_{1}\right)=\left(c_{1} \varphi_{1}+c_{2} \varphi_{2}+c_{3} \varphi_{3}+c_{4} \varphi_{4}+c_{5} \varphi_{5}\right)\left(e_{1}\right)=c_{1}
$$

类似地, $e_{2} \in U$, 所以 $c_{2}=0$. 因此我们有 $\varphi=c_{3} \varphi_{3}+c_{4} \varphi_{4}+c_{5} \varphi_{5}$. 于是 $\varphi \in$ $\operatorname{span}\left(\varphi_{3}, \varphi_{4}, \varphi_{5}\right)$ ，这表明 $U^{0} \subset \operatorname{span}\left(\varphi_{3}, \varphi_{4}, \varphi_{5}\right)$ 。

### 3.105 零化子是子空间

设 $U \subset V$, 则 $U^{0}$ 是 $V^{\prime}$ 的子空间.
证明 显然 $0 \in U^{0}$ （这里 0 表示 $V$ 上的零线性泛函），因为零线性泛函将 $U$ 中每个向量变为 0 。

设 $\varphi, \psi \in U^{0}$. 则 $\varphi, \psi \in V^{\prime}$ 且对每个 $u \in U$ 有 $\varphi(u)=\psi(u)=0$. 若 $u \in U$, 则 $(\varphi+\psi)(u)=\varphi(u)+\psi(u)=0+0=0$. 于是 $\varphi+\psi \in U^{0}$.

类似地， $U^{0}$ 在标量乘法下封闭。于是 1.34 表明 $U^{0}$ 是 $V^{\prime}$ 的子空间.
下面的命题表明 $\operatorname{dim} U^{0}$ 是 $\operatorname{dim} V$ 与 $\operatorname{dim} U$ 的差。例如，这意味着如果 $U$ 是 $\mathbf{R}^{5}$的二维子空间，则 $U^{0}$ 是 $\left(\mathbf{R}^{5}\right)^{\prime}$ 的三维子空间，见例3.104。

下面的命题可以仿照例 3.104 的方法来证明：选择 $U$ 的一个基 $u_{1}, \ldots, u_{m}$ ，将其扩充为 $V$ 的基 $u_{1}, \ldots, u_{m}, \ldots, u_{n}$ 。设 $\varphi_{1}, \ldots, \varphi_{m}, \ldots, \varphi_{n}$ 是 $V^{\prime}$ 的对偶基，然后证明 $\varphi_{m+1}, \ldots, \varphi_{n}$ 是 $U^{0}$ 的基，这就证明了想要的结果。

请读者按照上一段给出的证明梗概写出完整的证明，尽管下面我们给出了一个更简洁的证明。

### 3.106 零化子的维数

设 $V$ 是有限维的, $U$ 是 $V$ 的子空间. 则

$$
\operatorname{dim} U+\operatorname{dim} U^{0}=\operatorname{dim} V
$$

证明 设 $i \in \mathcal{L}(U, V)$ 是包含映射，定义如下：对 $u \in U$ 有 $i(u)=u$ 。则 $i^{\prime}$ 是 $V^{\prime}$ 到 $U^{\prime}$的线性映射。对 $i^{\prime}$ 应用线性映射基本定理 3.22 得

$$
\operatorname{dim} \text { range } i^{\prime}+\operatorname{dim} \text { null } i^{\prime}=\operatorname{dim} V^{\prime}
$$

而 null $i^{\prime}=U^{0}$ （可由定义得到）且 $\operatorname{dim} V^{\prime}=\operatorname{dim} V$ （由于 3.95），故上述等式变为

$$
\operatorname{dim} \operatorname{range} i^{\prime}+\operatorname{dim} U^{0}=\operatorname{dim} V \text {. }
$$

若 $\varphi \in U^{\prime}$ ，则 $\varphi$ 可以扩张为 $V$ 上的线性泛函 $\psi$ （例如，见3.A节的习题 11）。 $i^{\prime}$ 的定义表明 $i^{\prime}(\psi)=\varphi$ 。所以 $\varphi \in$ range $i^{\prime}$, 这表明 range $i^{\prime}=U^{\prime}$ 。因此 $\operatorname{dim}$ range $i^{\prime}=\operatorname{dim} U^{\prime}=\operatorname{dim} U$, 这就得到了想要的结论.

下面结果中的 (a) 的证明并不需要用到 $V$ 和 $W$ 都是有限维的这一假设.

## $3.107 T^{\prime}$ 的零空间

设 $V$ 和 $W$ 都是有限维， $T \in \mathcal{L}(V, W)$ 。则
(a) null $T^{\prime}=(\text { range } T)^{0}$;
(b) $\operatorname{dim} \operatorname{null} T^{\prime}=\operatorname{dim} \operatorname{null} T+\operatorname{dim} W-\operatorname{dim} V$.

## 证明

（a）首先设 $\varphi \in \operatorname{null} T^{\prime}$. 则 $0=T^{\prime}(\varphi)=\varphi \circ T$. 故对任意 $v \in V$ 有

$$
0=(\varphi \circ T)(v)=\varphi(T v)
$$

于是 $\varphi \in(\text { range } T)^{0}$ 。这表明 null $T^{\prime} \subset(\text { range } T)^{0}$ 。
为了证明反方向的包含关系, 设 $\varphi \in(\text { range } T)^{0}$ 。则对任意向量 $v \in V$ 有 $\varphi(T v)=$ 0 . 所以 $0=\varphi \circ T=T^{\prime}(\varphi)$ 。也就是说 $\varphi \in \operatorname{null} T^{\prime}$ ，这表明 $(\operatorname{range} T)^{0} \subset \operatorname{null} T^{\prime}$ ，这就证明了（a）。
(b) 我们有

$$
\begin{aligned}
\operatorname{dim} \operatorname{null} T^{\prime} & =\operatorname{dim}(\operatorname{range} T)^{0} \\
& =\operatorname{dim} W-\operatorname{dim} \operatorname{range} T \\
& =\operatorname{dim} W-(\operatorname{dim} V-\operatorname{dim} \operatorname{null} T) \\
& =\operatorname{dim} \operatorname{null} T+\operatorname{dim} W-\operatorname{dim} V
\end{aligned}
$$

这里第一个等号是利用 (a), 第二个等号是利用 3.106 , 第三个等号是利用线性映射基本定理 3.22.

下面的命题很有用，因为有时候证明 $T^{\prime}$ 是单的比直接证明 $T$ 是满的要更容易。

## $3.108 T$ 是满的等价于 $T^{\prime}$ 是单的

设 $V$ 和 $W$ 都是有限维的， $T \in \mathcal{L}(V, W)$. 则 $T$ 是满的当且仅当 $T^{\prime}$ 是单的.
证明 映射 $T \in \mathcal{L}(V, W)$ 是满的当且仅当 $\operatorname{range} T=W$ ，当且仅当 $(\operatorname{range} T)^{0}=\{0\}$ ，当且仅当 null $T^{\prime}=\{0\}$ （由于 3.107(a)），当且仅当 $T^{\prime}$ 是单的。

## $3.109 T^{\prime}$ 的值域

设 $V$ 和 $W$ 都是有限维的， $T \in \mathcal{L}(V, W)$. 则
(a) dim range $T^{\prime}=\operatorname{dim} \operatorname{range} T$;
(b) range $T^{\prime}=(\operatorname{null} T)^{0}$.

## 证明

(a) 我们有

$$
\begin{aligned}
\operatorname{dim} \operatorname{range} T^{\prime} & =\operatorname{dim} W^{\prime}-\operatorname{dim} \operatorname{null} T^{\prime} \\
& =\operatorname{dim} W-\operatorname{dim}(\operatorname{range} T)^{0} \\
& =\operatorname{dim} \operatorname{range} T
\end{aligned}
$$

这里第一个等号是利用线性映射基本定理 3.22，第二个等号是利用 3.95 和 3.107（a），第三个等号是利用 3.106。
(b) 首先设 $\varphi \in \operatorname{range} T^{\prime}$. 则存在 $\psi \in W^{\prime}$ 使得 $\varphi=T^{\prime}(\psi)$. 若 $v \in \operatorname{null} T$, 则

$$
\varphi(v)=\left(T^{\prime}(\psi)\right) v=(\psi \circ T)(v)=\psi(T v)=\psi(0)=0
$$

所以 $\varphi \in(\text { null } T)^{0}$ 。这表明 range $T^{\prime} \subset(\operatorname{null} T)^{0}$ 。
为完成证明，我们要证明 range $T^{\prime}$ 和 $(\text { null } T)^{0}$ 的维数相同，为此，注意到

$$
\begin{aligned}
\operatorname{dim} \operatorname{range} T^{\prime} & =\operatorname{dim} \operatorname{range} T \\
& =\operatorname{dim} V-\operatorname{dim} \operatorname{null} T \\
& =\operatorname{dim}(\operatorname{null} T)^{0}
\end{aligned}
$$

这里第一个等号是利用（a），第二个等号是利用线性映射基本定理 3.22，第三个等号是利用 3.106.

下面的结果应当与 3.108 相对照.

### 3.110 $T$ 是单的等价于 $T^{\prime}$ 是满的

设 $V$ 和 $W$ 都是有限维的， $T \in \mathcal{L}(V, W)$. 则 $T$ 是单的当且仅当 $T^{\prime}$ 是满的.
证明 映射 $T \in \mathcal{L}(V, W)$ 是单的当且仅当 null $T=\{0\}$ ，当且仅当 $(\operatorname{null} T)^{0}=V^{\prime}$ ，当且仅当 range $T^{\prime}=V^{\prime}$ （由于 3.109(b)），当且仅当 $T^{\prime}$ 是满的。

## 对偶映射的矩阵

现在我们定义矩阵的转置.
3.111 定义 转置（transpose）， $A^{\mathrm{t}}$

矩阵 $A$ 的转置（记为 $A^{\mathrm{t}}$ ）是通过互换 $A$ 的行和列的角色所得到的矩阵。确切地说，若 $A$ 是 $m \times n$ 矩阵，则 $A^{\mathrm{t}}$ 是 $n \times m$ 矩阵，其元素由下面的等式给出：

$$
\left(A^{t}\right)_{k, j}=A_{j, k}
$$

3.112 例 若 $A=\left(\begin{array}{cc}5 & -7 \\ 3 & 8 \\ -4 & 2\end{array}\right)$, 则 $A^{\mathrm{t}}=\left(\begin{array}{ccc}5 & 3 & -4 \\ -7 & 8 & 2\end{array}\right)$.

注意这里 $A$ 是 $3 \times 2$ 矩阵, $A^{\mathrm{t}}$ 是 $2 \times 3$ 矩阵.

转置有很好的代数性质：对所有 $m \times n$ 矩阵 $A, C$ 和所有 $\lambda \in \mathbf{F}$ 均有 $(A+C)^{\mathbf{t}}=$ $A^{\mathrm{t}}+C^{\mathrm{t}}$ 且 $(\lambda A)^{\mathrm{t}}=\lambda A^{\mathrm{t}}$ （见习题 33 ）。

以下命题表明两个矩阵的乘积的转置等于其转置按相反的顺序相乘.

### 3.113 矩阵乘积的转置

若 $A$ 是 $m \times n$ 矩阵, $C$ 是 $n \times p$ 矩阵, 则

$$
(A C)^{\mathrm{t}}=C^{\mathrm{t}} A^{\mathrm{t}}
$$

证明 设 $1 \leq k \leq p, 1 \leq j \leq m$ ，则

$$
\begin{aligned}
\left((A C)^{\mathrm{t}}\right)_{k, j} & =(A C)_{j, k} \\
& =\sum_{r=1}^{n} A_{j, r} C_{r, k} \\
& =\sum_{r=1}^{n}\left(C^{\mathrm{t}}\right)_{k, r}\left(A^{\mathrm{t}}\right)_{r, j} \\
& =\left(C^{\mathrm{t}} A^{\mathrm{t}}\right)_{k, j} .
\end{aligned}
$$

于是 $(A C)^{\mathrm{t}}=C^{\mathrm{t}} A^{\mathrm{t}}$.
对以下命题，我们假定有 $V$ 的基 $v_{1}, \ldots, v_{n}$ 及 $V^{\prime}$ 的对偶基 $\varphi_{1}, \ldots, \varphi_{n}$ ，并假定有 $W$ 的基 $w_{1}, \ldots, w_{m}$ 及 $W^{\prime}$ 的对偶基 $\psi_{1}, \ldots, \psi_{m}$ 。于是 $\mathcal{M}(T)$ 是按 $V$ 和 $W$ 的上述基计算， $\mathcal{M}\left(T^{\prime}\right)$ 是按 $W^{\prime}$ 和 $V^{\prime}$ 的上述对偶基计算。

## $3.114 T^{\prime}$ 的矩阵是 $T$ 的矩阵的转置

设 $T \in \mathcal{L}(V, W)$ ，则 $\mathcal{M}\left(T^{\prime}\right)=(\mathcal{M}(T))^{\mathrm{t}}$ 。
证明 设 $A=\mathcal{M}(T), C=\mathcal{M}\left(T^{\prime}\right)$, 再设 $1 \leq j \leq m, 1 \leq k \leq n$.
由 $\mathcal{M}\left(T^{\prime}\right)$ 的定义我们有

$$
T^{\prime}\left(\psi_{j}\right)=\sum_{r=1}^{n} C_{r, j} \varphi_{r}
$$

上面等式的左端等于 $\psi_{j} \circ T$. 于是将等式两端作用到 $v_{k}$ 上得到

$$
\begin{aligned}
\left(\psi_{j} \circ T\right)\left(v_{k}\right) & =\sum_{r=1}^{n} C_{r, j} \varphi_{r}\left(v_{k}\right) \\
& =C_{k, j} .
\end{aligned}
$$

我们还有

$$
\begin{aligned}
\left(\psi_{j} \circ T\right)\left(v_{k}\right) & =\psi_{j}\left(T v_{k}\right) \\
& =\psi_{j}\left(\sum_{r=1}^{m} A_{r, k} w_{r}\right)
\end{aligned}
$$

$$
\begin{aligned}
& =\sum_{r=1}^{m} A_{r, k} \psi_{j}\left(w_{r}\right) \\
& =A_{j, k} .
\end{aligned}
$$

比较上面两组等式的最后一行得 $C_{k, j}=A_{j, k}$. 于是 $C=A^{\mathrm{t}}$. 也就是说 $\mathcal{M}\left(T^{\prime}\right)=$ $(\mathcal{M}(T))^{\mathrm{t}}$ 。

## 矩阵的秩

我们首先定义与矩阵有关的两个非负整数。
3.115 定义 行秩（row rank）、列秩（column rank）

设 $A$ 是元素属于 $\mathbf{F}$ 的 $m \times n$ 矩阵。

- $A$ 的行秩是 $A$ 的诸行在 $\mathbf{F}^{1, n}$ 中的张成空间的维数。
- $A$ 的列秩是 $A$ 的诸列在 $\mathbf{F}^{m, 1}$ 中的张成空间的维数。
3.116 例 设 $A=\left(\begin{array}{llll}4 & 7 & 1 & 8 \\ 3 & 5 & 2 & 9\end{array}\right)$. 求 $A$ 的行秩和列秩.

解 $A$ 的行秩等于 $\mathbf{F}^{1,4}$ 中

$$
\operatorname{span}\left(\left(\begin{array}{llll}
4 & 7 & 1 & 8
\end{array}\right),\left(\begin{array}{llll}
3 & 5 & 2 & 9
\end{array}\right)\right)
$$

的维数. $\mathbf{F}^{1,4}$ 中这两个向量任何一个都不是另一个的标量倍, 所以这个长度为 2 的组的张成空间的维数为 2 . 也就是说， $A$ 的行秩是 2 。
$A$ 的列秩是 $\mathbf{F}^{2,1}$ 中

$$
\operatorname{span}\left(\binom{4}{3},\binom{7}{5},\binom{1}{2},\binom{8}{9}\right)
$$

的维数. $\mathbf{F}^{2,1}$ 中上述组的前两个向量中的任何一个都不是另一个的标量倍, 所以这个长度为 4 的组的张成空间的维数至少是 2 . 因为 $\operatorname{dim} \mathbf{F}^{2,1}=2$ ，所以 $\mathbf{F}^{2,1}$ 中这个向量组的张成空间的维数不可能大于 2 . 于是这个向量组的张成空间的维数是 2 . 也就是说， $A$ 的列秩是 2 。

注意在下面结果的陈述中并没有出现基。虽然下面结果中的 $\mathcal{M}(T)$ 依赖于 $V$ 和 $W$ 的基的选取，但是下面的结果表明 $\mathcal{M}(T)$ 的列秩对于选定的每一组基都是相同的 （因为 range $T$ 并不依赖于基的选取）。

### 3.117 range $T$ 的维数等于 $\mathcal{M}(T)$ 的列秩

设 $V$ 和 $W$ 都是有限维的， $T \in \mathcal{L}(V, W)$ 。则 $\operatorname{dim} \operatorname{range} T$ 等于 $\mathcal{M}(T)$ 的列秩.

证明 设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基， $w_{1}, \ldots, w_{m}$ 是 $W$ 的基。则将 $w \in \operatorname{span}\left(T v_{1}, \ldots, T v_{n}\right)$变为 $\mathcal{M}(w)$ 的函数是从 $\operatorname{span}\left(T v_{1}, \ldots, T v_{n}\right)$ 到 $\operatorname{span}\left(\mathcal{M}\left(T v_{1}\right), \ldots, \mathcal{M}\left(T v_{n}\right)\right)$ 的同构。于是 $\operatorname{dim} \operatorname{span}\left(T v_{1}, \ldots, T v_{n}\right)=\operatorname{dim} \operatorname{span}\left(\mathcal{M}\left(T v_{1}\right), \ldots, \mathcal{M}\left(T v_{n}\right)\right)$ ，这里最后一个维数等于 $\mathcal{M}(T)$ 的列秩。

容易看出 range $T=\operatorname{span}\left(T v_{1}, \ldots, T v_{n}\right)$ 。 于是 $\operatorname{dim} \operatorname{range} T=\operatorname{dim} \operatorname{span}\left(T v_{1}, \ldots\right.$, $\left.T v_{n}\right)=\mathcal{M}(T)$ 的列秩。

在例 3.116 中行秩和列秩相等。 以下命题表明这个结论恒成立.

### 3.118 行秩等于列秩

设 $A \in \mathbf{F}^{m, n}$ ，则 $A$ 的行秩等于 $A$ 的列秩.
证明 定义 $T: \mathbf{F}^{n, 1} \rightarrow \mathbf{F}^{m, 1}$ 为 $T x=A x$ 。则 $\mathcal{M}(T)=A$ ，这里 $\mathcal{M}(T)$ 按 $\mathbf{F}^{n, 1}$ 和 $\mathbf{F}^{m, 1}$的标准基计算。现在

$$
\begin{aligned}
A \text { 的列秩 } & =\mathcal{M}(T) \text { 的列秩 } \\
& =\operatorname{dim} \operatorname{range} T \\
& =\operatorname{dim} \operatorname{range} T^{\prime} \\
& =\mathcal{M}\left(T^{\prime}\right) \text { 的列秩 } \\
& =A^{\mathrm{t}} \text { 的列秩 } \\
& =A \text { 的行秩, }
\end{aligned}
$$

这里第二个等号是利用 3.117，第三个等号是利用 3.109(a)，第四个等号是利用 3.117 （其中 $\mathcal{M}\left(T^{\prime}\right)$ 按照标准基的对偶基计算），第五个等号是利用 3.114 ，最后一个等号是利用定义。

以上命题使得我们可以不区分 "行秩" 和 "列秩" 这两个术语，而直接使用更简单的术语 "秩"。

### 3.119 定义 秩（rank）

矩阵的 $A \in \mathbf{F}^{m, n}$ 的秩定义为 $A$ 的列秩。

## 习题 3.F

1 解释为什么每个线性泛函或者是满的或者是零映射.
2 给出 $\mathbf{R}^{[0,1]}$ 上三个不同的线性泛函的例子。
3 设 $V$ 是有限维的， $v \in V$ 且 $v \neq 0$. 证明存在 $\varphi \in V^{\prime}$ 使得 $\varphi(v)=1$.
4 设 $V$ 是有限维的， $U$ 是 $V$ 的子空间使得 $U \neq V$ 。证明存在 $\varphi \in V^{\prime}$ 使得对每个 $u \in U$ 有 $\varphi(u)=0$ 但 $\varphi \neq 0$ 。

5 设 $V_{1}, \ldots, V_{m}$ 均为向量空间。证明 $\left(V_{1} \times \cdots \times V_{m}\right)^{\prime}$ 和 $V_{1}{ }^{\prime} \times \cdots \times V_{m}{ }^{\prime}$ 是同构的向量空间。

6 设 $V$ 是有限维的， $v_{1}, \ldots, v_{m} \in V$ 。定义线性映射 $\Gamma: V^{\prime} \rightarrow \mathbf{F}^{m}$ 如下：

$$
\Gamma(\varphi)=\left(\varphi\left(v_{1}\right), \ldots, \varphi\left(v_{m}\right)\right)
$$

(a) 证明 $v_{1}, \ldots, v_{m}$ 张成 $V$ 当且仅当 $\Gamma$ 是单的.
(b) 证明 $v_{1}, \ldots, v_{m}$ 是线性无关的当且仅当 $\Gamma$ 是满的.

7 设 $m$ 是正整数。证明 $\mathcal{P}_{m}(\mathbf{R})$ 的基 $1, x, \ldots, x^{m}$ 的对偶基是 $\varphi_{0}, \varphi_{1}, \ldots, \varphi_{m}$ ，其中 $\varphi_{j}(p)=\frac{p^{(j)}(0)}{j!}, p^{(j)}$ 表示 $p$ 的 $j$ 次导数， $p$ 的 0 次导数规定为 $p$ 。

8 设 $m$ 是正整数.
（a）证明 $1, x-5, \ldots,(x-5)^{m}$ 是 $\mathcal{P}_{m}(\mathbf{R})$ 的基.
（b）求（a）中的基的对偶基.
9 设 $v_{1}, \ldots, v_{n}$ 是 $V$ 的基， $\varphi_{1}, \ldots, \varphi_{n}$ 是 $V^{\prime}$ 的相应的对偶基。设 $\psi \in V^{\prime}$ 。证明

$$
\psi=\psi\left(v_{1}\right) \varphi_{1}+\cdots+\psi\left(v_{n}\right) \varphi_{n}
$$

10 证明 3.101 的前两条。
11 设 $A$ 是 $m \times n$ 矩阵且 $A \neq 0$. 证明 $A$ 的秩是 1 当且仅当存在 $\left(c_{1}, \ldots, c_{m}\right) \in \mathbf{F}^{m}$和 $\left(d_{1}, \ldots, d_{n}\right) \in \mathbf{F}^{n}$ 使得对任意 $j=1, \ldots, m$ 和 $k=1, \ldots, n$ 有 $A_{j, k}=c_{j} d_{k}$.
12 证明 $V$ 的恒等映射的对偶映射是 $V^{\prime}$ 的恒等映射。
13 定义 $T: \mathbf{R}^{3} \rightarrow \mathbf{R}^{2}$ 为 $T(x, y, z)=(4 x+5 y+6 z, 7 x+8 y+9 z)$ 。设 $\varphi_{1}, \varphi_{2}$ 是 $\mathbf{R}^{2}$的标准基的对偶基, $\psi_{1}, \psi_{2}, \psi_{3}$ 是 $\mathbf{R}^{3}$ 的标准基的对偶基.
(a) 描述线性泛函 $T^{\prime}\left(\varphi_{1}\right)$ 和 $T^{\prime}\left(\varphi_{2}\right)$.
(b) 将 $T^{\prime}\left(\varphi_{1}\right)$ 和 $T^{\prime}\left(\varphi_{2}\right)$ 写成 $\psi_{1}, \psi_{2}, \psi_{3}$ 的线性组合.

14 定义 $T: \mathcal{P}(\mathbf{R}) \rightarrow \mathcal{P}(\mathbf{R})$ 如下: 对 $x \in \mathbf{R}$ 有 $(T p)(x)=x^{2} p(x)+p^{\prime \prime}(x)$.
(a) 设 $\varphi \in \mathcal{P}(\mathbf{R})^{\prime}$ 定义为 $\varphi(p)=p^{\prime}(4)$. 描述 $\mathcal{P}(\mathbf{R})$ 上的线性泛函 $T^{\prime}(\varphi)$.
(b) 设 $\varphi \in \mathcal{P}(\mathbf{R})^{\prime}$ 定义为 $\varphi(p)=\int_{0}^{1} p(x) \mathrm{d} x$. 求 $\left(T^{\prime}(\varphi)\right)\left(x^{3}\right)$.

15 设 $W$ 是有限维的， $T \in \mathcal{L}(V, W)$ 。证明 $T^{\prime}=0$ 当且仅当 $T=0$.
16 设 $V$ 和 $W$ 都是有限维的。证明将 $T \in \mathcal{L}(V, W)$ 变为 $T^{\prime} \in \mathcal{L}\left(W^{\prime}, V^{\prime}\right)$ 的映射是 $\mathcal{L}(V, W)$ 到 $\mathcal{L}\left(W^{\prime}, V^{\prime}\right)$ 的同构。
17 设 $U \subset V$. 说明为什么 $U^{0}=\left\{\varphi \in V^{\prime}: U \subset \operatorname{null} \varphi\right\}$.
18 设 $V$ 是有限维的， $U \subset V$ 。证明 $U=\{0\}$ 当且仅当 $U^{0}=V^{\prime}$ 。
19 设 $V$ 是有限维的， $U$ 是 $V$ 的子空间。证明 $U=V$ 当且仅当 $U^{0}=\{0\}$.
20 设 $U$ 和 $W$ 均为 $V$ 的子集， $U \subset W$ 。证明 $W^{0} \subset U^{0}$ 。

21 设 $V$ 是有限维的， $U$ 和 $W$ 均为 $V$ 的子空间且 $W^{0} \subset U^{0}$ 。证明 $U \subset W$.
22 设 $U, W$ 均为 $V$ 的子空间。证明 $(U+W)^{0}=U^{0} \cap W^{0}$ 。
23 设 $V$ 是有限维的，且 $U$ 和 $W$ 均为 $V$ 的子空间。证明 $(U \cap W)^{0}=U^{0}+W^{0}$ 。
24 使用 3.106 之前描述的想法证明 3.106.
25 设 $V$ 是有限维的，且 $U$ 是 $V$ 的子空间。证明

$$
U=\left\{v \in V: \text { 对任意 } \varphi \in U^{0} \text { 均有 } \varphi(v)=0\right\} \text {. }
$$

26 设 $V$ 是有限维的且 $\Gamma$ 是 $V^{\prime}$ 的子空间。证明

$$
\Gamma=\{v \in V: \text { 对任意 } \varphi \in \Gamma \text { 均有 } \varphi(v)=0\}^{0} .
$$

27 设 $T \in \mathcal{L}\left(\mathcal{P}_{5}(\mathbf{R}), \mathcal{P}_{5}(\mathbf{R})\right)$ 且 $\operatorname{null} T^{\prime}=\operatorname{span}(\varphi)$, 这里 $\varphi$ 是 $\mathcal{P}_{5}(\mathbf{R})$ 上的由 $\varphi(p)=$ $p(8)$ 定义的线性泛函。证明 range $T=\left\{p \in \mathcal{P}_{5}(\mathbf{R}): p(8)=0\right\}$.
28 设 $V$ 和 $W$ 都是有限维的， $T \in \mathcal{L}(V, W)$ ，且存在 $\varphi \in W^{\prime}$ 使得 null $T^{\prime}=\operatorname{span}(\varphi)$ 。证明 range $T=\operatorname{null} \varphi$ 。
29 设 $V$ 和 $W$ 都是有限维的， $T \in \mathcal{L}(V, W)$ ，且存在 $\varphi \in V^{\prime}$ 使得 $\operatorname{range} T^{\prime}=\operatorname{span}(\varphi)$ 。证明 null $T=\operatorname{null} \varphi$ 。
30 设 $V$ 是有限维的， $\varphi_{1}, \ldots, \varphi_{m}$ 是 $V^{\prime}$ 中的一个线性无关组. 证明

$$
\operatorname{dim}\left(\left(\operatorname{null} \varphi_{1}\right) \cap \cdots \cap\left(\operatorname{null} \varphi_{m}\right)\right)=(\operatorname{dim} V)-m
$$

31 设 $V$ 是有限维的， $\varphi_{1}, \ldots, \varphi_{n}$ 是 $V^{\prime}$ 的基。证明存在 $V$ 的基使得其对偶基是 $\varphi_{1}, \ldots, \varphi_{n}$.
32 设 $T \in \mathcal{L}(V)$, 并设 $u_{1}, \ldots, u_{n}$ 和 $v_{1}, \ldots, v_{n}$ 均为 $V$ 的基. 证明以下命题等价:
(a) $T$ 是可逆的.
(b) $\mathcal{M}(T)$ 的诸列在 $\mathbf{F}^{n, 1}$ 中是线性无关的.
(c) $\mathcal{M}(T)$ 的诸列张成 $\mathbf{F}^{n, 1}$.
(d) $\mathcal{M}(T)$ 的诸行在 $\mathbf{F}^{1, n}$ 中是线性无关的.
(e) $\mathcal{M}(T)$ 的诸行张成 $\mathbf{F}^{1, n}$.

这里 $\mathcal{M}(T)$ 表示 $\mathcal{M}\left(T,\left(u_{1}, \ldots, u_{n}\right),\left(v_{1}, \ldots, u_{n}\right)\right)$.
33 设 $m$ 和 $n$ 均为正整数。证明将 $A$ 变为 $A^{\mathrm{t}}$ 的函数是从 $\mathbf{F}^{m, n}$ 到 $\mathbf{F}^{n, m}$ 的线性映射。进一步，证明这个线性映射是可逆的。

34 定义 $V$ 的二次对偶空间（记为 $V^{\prime \prime}$ ）为 $V^{\prime}$ 的对偶空间。也就是说， $V^{\prime \prime}=\left(V^{\prime}\right)^{\prime}$ 。定义 $\Lambda: V \rightarrow V^{\prime \prime}$ 如下：对于 $v \in V$ 和 $\varphi \in V^{\prime}$,

$$
(\Lambda v)(\varphi)=\varphi(v)
$$

(a) 证明 $\Lambda$ 是从 $V$ 到 $V^{\prime \prime}$ 的线性映射.
(b) 证明: 若 $T \in \mathcal{L}(V)$, 则 $T^{\prime \prime} \circ \Lambda=\Lambda \circ T$, 这里 $T^{\prime \prime}=\left(T^{\prime}\right)^{\prime}$.
(c) 证明: 若 $V$ 是有限维的, 则 $\Lambda$ 是 $V$ 到 $V^{\prime \prime}$ 的同构.

设 $V$ 是有限维的。则 $V$ 和 $V^{\prime}$ 同构，但是找 $V$ 到 $V^{\prime}$ 的同构一般来说需要选择 $V$的一个基。相比之下，从 $V$ 到 $V^{\prime \prime}$ 的同构 $\Lambda$ 并不依赖于基的选取，因此更加自然。
35 证明 $(\mathcal{P}(\mathbf{R}))^{\prime}$ 和 $\mathbf{R}^{\infty}$ 是同构的。
36 设 $U$ 是 $V$ 的子空间。设 $i: U \rightarrow V$ 是由 $i(u)=u$ 定义的包含映射. 那么 $i^{\prime} \in$ $\mathcal{L}\left(V^{\prime}, U^{\prime}\right)$.
(a) 证明 null $i^{\prime}=U^{0}$.
(b) 证明若 $V$ 是有限维的, 则 range $i^{\prime}=U^{\prime}$.
(c) 证明若 $V$ 是有限维的，则 $\tilde{i^{\prime}}$ 是 $V^{\prime} / U^{0}$ 到 $U^{\prime}$ 的同构.

注意（c）中的同构并不依赖于其中任何一个向量空间的基的选取，因而是自然的.

37 设 $U$ 是 $V$ 的子空间， $\pi: V \rightarrow V / U$ 是通常的商映射，则 $\pi^{\prime} \in \mathcal{L}\left((V / U)^{\prime}, V^{\prime}\right)$.
(a) 证明 $\pi^{\prime}$ 是单的.
(b) 证明 range $\pi^{\prime}=U^{0}$.
(c) $\pi^{\prime}$ 是 $(V / U)^{\prime}$ 到 $U^{0}$ 的同构.

注意（c）中的同构并不依赖于其中任何一个向量空间的基的选取，因而是自然的。事实上，这里并没有假定这些向量空间是有限维的.

